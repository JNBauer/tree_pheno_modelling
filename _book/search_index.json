[["filling-gaps-in-temperature-records.html", "Chapter 10 Filling gaps in temperature records", " Chapter 10 Filling gaps in temperature records 1. Use chillR functions to find out how many gaps you have in this dataset (even if you have none, please still follow all further steps) fixed_weather &lt;- fix_weather(CapeTown_weather_gap) Season End_year Season_days Data_days Missing_Tmin Missing_Tmax Incomplete_days Perc_complete 1989/1990 1990 365 365 0 0 0 100.0 1990/1991 1991 365 365 0 0 0 100.0 1991/1992 1992 366 366 0 0 0 100.0 1992/1993 1993 365 365 0 0 0 100.0 1993/1994 1994 365 365 0 0 0 100.0 1994/1995 1995 365 365 0 0 0 100.0 1995/1996 1996 366 366 0 0 0 100.0 1996/1997 1997 365 365 0 0 0 100.0 1997/1998 1998 365 365 0 0 0 100.0 1998/1999 1999 365 365 1 1 1 99.7 1999/2000 2000 366 366 1 0 1 99.7 2000/2001 2001 365 365 0 0 0 100.0 2001/2002 2002 365 365 0 0 0 100.0 2002/2003 2003 365 365 1 1 1 99.7 2003/2004 2004 366 366 0 0 0 100.0 2004/2005 2005 365 365 0 0 0 100.0 2005/2006 2006 365 365 0 0 0 100.0 2006/2007 2007 365 365 0 0 0 100.0 2007/2008 2008 366 366 0 0 0 100.0 2008/2009 2009 365 365 0 0 0 100.0 2009/2010 2010 365 365 0 0 0 100.0 2010/2011 2011 365 365 0 0 0 100.0 2011/2012 2012 366 366 0 0 0 100.0 2012/2013 2013 365 365 0 0 0 100.0 2013/2014 2014 365 365 0 0 0 100.0 2014/2015 2015 365 365 1 1 1 99.7 2015/2016 2016 366 366 0 0 0 100.0 2016/2017 2017 365 365 0 0 0 100.0 2017/2018 2018 365 365 0 0 0 100.0 2018/2019 2019 365 365 0 0 0 100.0 2019/2020 2020 366 366 1 1 1 99.7 2. Create a list of the 25 closest weather stations using the handle_gsod function patching_station_list&lt;-handle_gsod(action=&quot;list_stations&quot;, location=c(18.93521767626777, -34.10835247406239), time_interval=c(1977,2020), stations_to_choose_from = 25) chillR_code STATION.NAME CTRY Lat Long BEGIN END distance Overlap_years Perc_interval_covered 688160_99999 CAPE TOWN INTL SF -33.965 18.602 19490101 20221215 19.61 44.00 100.00 689990_99999 CT-AWS SF -33.967 18.600 20041102 20221215 19.81 16.16 36.73 689110_99999 STRAND SF -34.150 18.850 20040525 20220328 21.66 16.60 37.74 689250_99999 ELGIN EXP FARM SF -34.139 19.023 19980301 20221215 27.93 22.84 51.90 688270_99999 YSTERPLANT(SAAFB) SF -33.900 18.500 20040224 20201230 29.71 16.85 38.30 687130_99999 PAARL SF -33.717 18.967 20040608 20221215 30.15 16.57 37.65 688170_99999 CAPE TOWN - PORTNET SF -33.900 18.433 19980301 20221215 35.79 22.84 51.90 688190_99999 MOLTENO RESERVIOR SF -33.933 18.417 20131210 20221215 36.80 7.06 16.04 689140_99999 SIMONSTOWN SF -34.200 18.433 19490101 19500625 44.31 0.00 0.00 688130_99999 ROBBEN ISLAND SF -33.800 18.367 20041005 20221215 44.87 16.24 36.91 ## chr &quot;CAPE TOWN INTL&quot; 3. Identify suitable weather stations for patching gaps The CAPE TOWN INTL station on the first position or the ROBBEN ISLAND station on position 10 could be suitable stations for patching gaps in our main data set. The CAPE TOWN INTL station is characterized by a close distance to the location of interest and the ROBBEN ISLAND station by its completeness. 4. Download weather data for promising stations, convert them to chillR format and compile them in a list positions_in_station_list&lt;-c(1,5,10) patch_weather&lt;-list() for(i in 1:length(positions_in_station_list)) {patch_weather[[i]]&lt;-handle_gsod(handle_gsod(action=&quot;download_weather&quot;, location=patching_station_list$chillR_code[ positions_in_station_list[i]], time_interval=c(1977,2020)))[[1]]$weather names(patch_weather)[i]&lt;-patching_station_list$STATION.NAME[ positions_in_station_list[i]] } 5. Use the patch_daily_temperatures function to fill gaps patched &lt;- patch_daily_temperatures(weather = CapeTown_weather_gap, patch_weather = patch_weather) # ,max_mean_bias = 1, # max_stdev_bias = 2) The tables show the progress made during patching (#tab:Creating table for patching stats)Patch statistics for ELGIN EXP FARM mean_bias stdev_bias filled gaps_remain Tmin 1.430 2.126 1 4 Tmax -0.702 2.978 0 4 (#tab:Creating table for patching stats)Patch statistics for PAARL mean_bias stdev_bias filled gaps_remain Tmin -0.597 2.305 0 4 Tmax -4.134 3.377 0 4 (#tab:Creating table for patching stats)Patch statistics for PAARL mean_bias stdev_bias filled gaps_remain Tmin -1.302 2.923 0 4 Tmax 2.864 2.878 0 4 Stdev_bias too high! 6. Investigate the results - have all gaps been filled? patched_fixed_weather &lt;- fix_weather(patched) final_patched_fixed_weather &lt;- fix_weather(patched_fixed_weather) (#tab:Creating tables for QC)Quality check after the patching procedure Season End_year Season_days Data_days Missing_Tmin Missing_Tmax Incomplete_days Perc_complete 1989/1990 1990 365 365 0 0 0 100.0 1990/1991 1991 365 365 0 0 0 100.0 1991/1992 1992 366 366 0 0 0 100.0 1992/1993 1993 365 365 0 0 0 100.0 1993/1994 1994 365 365 0 0 0 100.0 1994/1995 1995 365 365 0 0 0 100.0 1995/1996 1996 366 366 0 0 0 100.0 1996/1997 1997 365 365 0 0 0 100.0 1997/1998 1998 365 365 0 0 0 100.0 1998/1999 1999 365 365 1 1 1 99.7 1999/2000 2000 366 366 0 0 0 100.0 2000/2001 2001 365 365 0 0 0 100.0 2001/2002 2002 365 365 0 0 0 100.0 2002/2003 2003 365 365 1 1 1 99.7 2003/2004 2004 366 366 0 0 0 100.0 2004/2005 2005 365 365 0 0 0 100.0 2005/2006 2006 365 365 0 0 0 100.0 2006/2007 2007 365 365 0 0 0 100.0 2007/2008 2008 366 366 0 0 0 100.0 2008/2009 2009 365 365 0 0 0 100.0 2009/2010 2010 365 365 0 0 0 100.0 2010/2011 2011 365 365 0 0 0 100.0 2011/2012 2012 366 366 0 0 0 100.0 2012/2013 2013 365 365 0 0 0 100.0 2013/2014 2014 365 365 0 0 0 100.0 2014/2015 2015 365 365 1 1 1 99.7 2015/2016 2016 366 366 0 0 0 100.0 2016/2017 2017 365 365 0 0 0 100.0 2017/2018 2018 365 365 0 0 0 100.0 2018/2019 2019 365 365 0 0 0 100.0 2019/2020 2020 366 366 1 1 1 99.7 (#tab:Creating tables for QC)Quality check after fixing left over gaps Season End_year Season_days Data_days Missing_Tmin Missing_Tmax Incomplete_days Perc_complete Length:31 Min. :1990 Min. :365.0 Min. :365.0 Min. :0 Min. :0 Min. :0 Min. :100 Class :character 1st Qu.:1998 1st Qu.:365.0 1st Qu.:365.0 1st Qu.:0 1st Qu.:0 1st Qu.:0 1st Qu.:100 Mode :character Median :2005 Median :365.0 Median :365.0 Median :0 Median :0 Median :0 Median :100 NA Mean :2005 Mean :365.3 Mean :365.3 Mean :0 Mean :0 Mean :0 Mean :100 NA 3rd Qu.:2012 3rd Qu.:365.5 3rd Qu.:365.5 3rd Qu.:0 3rd Qu.:0 3rd Qu.:0 3rd Qu.:100 NA Max. :2020 Max. :366.0 Max. :366.0 Max. :0 Max. :0 Max. :0 Max. :100 7. If necessary, repeat until you have a dataset you can work with in further analyses The last single day gaps were fixed with the fixed_weather command. For further analyses, i will use the original dataset without the artificial gap.Gaps of single days are interpolated with fixed_weather. cleaned_weather &lt;- read.csv(&quot;data/CapeTown_chillR_weather.csv&quot;) "]]
