[["manual-chill-analysis.html", "Chapter 6 Manual chill analysis", " Chapter 6 Manual chill analysis 1. Write a basic function that calculates warm hours (&gt;25°C) The Winters_hours_gaps dataset is part of the ChillR package. It was recorded 2008 in a walnut orchard in Winters, California. The dataset was modified by excluding a not used Temp_gaps column. Table 6.1: Table for the modified Winters_hours_gaps dataset Year Month Day Hour Temp 2008 3 3 10 15.127 2008 3 3 11 17.153 2008 3 3 12 18.699 2008 3 3 13 18.699 2008 3 3 14 18.842 The function creates a new column Warming_hours that contains the result of the comparison if hourtemps$Tempis greater than 25. WH &lt;- function(hourtemps) { hourtemps[,&quot;Warming_hours&quot;] &lt;- hourtemps$Temp&gt;25 return(hourtemps) } 2. Apply this function to the Winters_hours_gaps dataset Winters_hours_gaps_plus_WH &lt;- WH(Winters_hours_gaps) sum_whgpWH &lt;- sum(Winters_hours_gaps_plus_WH$Warming_hours) When applying the function to the Winter_hours_gaps dataset and taking the sum of the Winters_hours_gaps_plus_WH$Warming_hours coloumn, 1275 hours over 25°C occured. In a table, it could be displayed like this. Table 6.2: Table for Winters_hours_gaps_plus_WH Year Month Day Hour Temp_gaps Temp 2008 8 17 9 22.082 22.082 2008 8 17 10 24.508 24.508 2008 8 17 11 25.404 25.404 2008 8 17 12 26.842 26.842 2008 8 17 13 28.171 28.171 2008 8 17 14 27.949 27.949 2008 8 17 15 NA NA 2008 8 17 16 NA NA 2008 8 17 17 NA NA 2008 8 17 18 NA NA 2008 8 17 19 NA NA 3. Extend this function, so that it can take start and end dates as inputs and sums up warm hours between these dates The following function contains additional input variables for the start and end dates. The variables are used to index the correct rows between which the sum of the warm hours should be taken. The previously created WH function is used to compare the temperature to the threshold. WH_YEARMODA &lt;- function(hourtemps, start_dateYEARMODA, end_dateYEARMODA, start_hour=12, end_hour=12) { start_year &lt;- as.numeric(substr(start_dateYEARMODA, 1, 4)) start_month &lt;- as.numeric(substr(start_dateYEARMODA, 5, 6)) start_day &lt;- as.numeric(substr(start_dateYEARMODA, 7, 8)) end_year &lt;- as.numeric(substr(end_dateYEARMODA, 1, 4)) end_month &lt;- as.numeric(substr(end_dateYEARMODA, 5, 6)) end_day &lt;- as.numeric(substr(end_dateYEARMODA, 7, 8)) start_date &lt;- which(hourtemps$Year==start_year &amp; hourtemps$Month==start_month &amp; hourtemps$Day==start_day &amp; hourtemps$Hour==start_hour) end_date &lt;- which(hourtemps$Year==end_year &amp; hourtemps$Month==end_month &amp; hourtemps$Day==end_day &amp; hourtemps$Hour==end_hour) warm_hours &lt;- WH(hourtemps) WHs &lt;- sum(warm_hours[start_date:end_date, &quot;Warming_hours&quot;]) return(WHs) } warming_hours_for_time_frame &lt;- WH_YEARMODA(hourtemps, 20080501, 20080831) Between the 1th of May 2008 (20080501) and the 31th of August 2008 (20080831), 957 hours over 25°C occurred. "]]
