<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 20 PLS regression with agroclimatic metrics | Tree phenology analysis with R - Logbook</title>
  <meta name="description" content="The logbook for the Tree phenology analysis with R logbook" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 20 PLS regression with agroclimatic metrics | Tree phenology analysis with R - Logbook" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="The logbook for the Tree phenology analysis with R logbook" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 20 PLS regression with agroclimatic metrics | Tree phenology analysis with R - Logbook" />
  
  <meta name="twitter:description" content="The logbook for the Tree phenology analysis with R logbook" />
  

<meta name="author" content="Julian Bauer" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="successes-and-limitations-of-pls-regression-analysis.html"/>
<link rel="next" href="examples-of-pls-regression-with-agroclimatic-metrics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<link href="libs/leaflet-minimap-3.3.1/Control.MiniMap.min.css" rel="stylesheet" />
<script src="libs/leaflet-minimap-3.3.1/Control.MiniMap.min.js"></script>
<script src="libs/leaflet-minimap-3.3.1/Minimap-binding.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.9/grViz.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree phenology Logbook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>2</b> Packages</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="packages.html"><a href="packages.html#bookdown"><i class="fa fa-check"></i><b>2.0.1</b> Bookdown</a></li>
<li class="chapter" data-level="2.0.2" data-path="packages.html"><a href="packages.html#chillr"><i class="fa fa-check"></i><b>2.0.2</b> chillR</a></li>
<li class="chapter" data-level="2.0.3" data-path="packages.html"><a href="packages.html#dplyr-family"><i class="fa fa-check"></i><b>2.0.3</b> dplyr family</a></li>
<li class="chapter" data-level="2.0.4" data-path="packages.html"><a href="packages.html#ggplot2"><i class="fa fa-check"></i><b>2.0.4</b> ggplot2</a></li>
<li class="chapter" data-level="2.0.5" data-path="packages.html"><a href="packages.html#leaflet"><i class="fa fa-check"></i><b>2.0.5</b> leaflet</a></li>
<li class="chapter" data-level="2.0.6" data-path="packages.html"><a href="packages.html#kableextra"><i class="fa fa-check"></i><b>2.0.6</b> kableExtra</a></li>
<li class="chapter" data-level="2.0.7" data-path="packages.html"><a href="packages.html#plotly"><i class="fa fa-check"></i><b>2.0.7</b> plotly</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tree-dormancy.html"><a href="tree-dormancy.html"><i class="fa fa-check"></i><b>3</b> Tree dormancy</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tree-dormancy.html"><a href="tree-dormancy.html#put-yourself-in-the-place-of-a-breeder-who-wants-to-calculate-the-temperature-requirements-of-a-newly-released-cultivar.-which-method-will-you-use-to-calculate-the-chilling-and-forcing-periods-please-justify-your-answer."><i class="fa fa-check"></i><b>3.1</b> Put yourself in the place of a breeder who wants to calculate the temperature requirements of a newly released cultivar. Which method will you use to calculate the chilling and forcing periods? Please justify your answer.</a></li>
<li class="chapter" data-level="3.2" data-path="tree-dormancy.html"><a href="tree-dormancy.html#which-are-the-advantages-2-of-the-bbch-scale-compared-with-earlies-scales"><i class="fa fa-check"></i><b>3.2</b> Which are the advantages (2) of the BBCH scale compared with earlies scales?</a></li>
<li class="chapter" data-level="3.3" data-path="tree-dormancy.html"><a href="tree-dormancy.html#classify-the-following-phenological-stages-of-sweet-cherry-according-to-the-bbch-scale"><i class="fa fa-check"></i><b>3.3</b> Classify the following phenological stages of sweet cherry according to the BBCH scale:</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html"><i class="fa fa-check"></i><b>4</b> Climate change and impact projection</a>
<ul>
<li class="chapter" data-level="4.1" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#list-the-main-drivers-of-climate-change-at-the-decade-to-century-scale-and-briefly-explain-the-mechanism-through-which-the-currently-most-important-driver-affects-our-climate."><i class="fa fa-check"></i><b>4.1</b> List the main drivers of climate change at the decade to century scale, and briefly explain the mechanism through which the currently most important driver affects our climate.</a></li>
<li class="chapter" data-level="4.2" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#explain-briefly-what-is-special-about-temperature-dynamics-of-the-recent-decades-and-why-we-have-good-reasons-to-be-concerned."><i class="fa fa-check"></i><b>4.2</b> Explain briefly what is special about temperature dynamics of the recent decades, and why we have good reasons to be concerned.</a></li>
<li class="chapter" data-level="4.3" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#what-does-the-abbreviation-rcp-stand-for-how-are-rcps-defined-and-what-is-their-role-in-projecting-future-climates"><i class="fa fa-check"></i><b>4.3</b> What does the abbreviation ‘RCP’ stand for, how are RCPs defined, and what is their role in projecting future climates?</a></li>
<li class="chapter" data-level="4.4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#briefly-describe-the-3-climate-impact-projection-methods-described-in-the-fourth-video."><i class="fa fa-check"></i><b>4.4</b> Briefly describe the 3 climate impact projection methods described in the fourth video.</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#statistical-models"><i class="fa fa-check"></i><b>4.4.1</b> Statistical models</a></li>
<li class="chapter" data-level="4.4.2" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#process-based-models"><i class="fa fa-check"></i><b>4.4.2</b> Process-based models</a></li>
<li class="chapter" data-level="4.4.3" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#climate-analogue-models"><i class="fa fa-check"></i><b>4.4.3</b> Climate analogue models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html"><i class="fa fa-check"></i><b>5</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="5.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#sketch-out-three-data-access-and-processing-challenges-that-had-to-be-overcome-in-order-to-produce-chill-projections-with-state-of-the-art-methodology."><i class="fa fa-check"></i><b>5.1</b> Sketch out three data access and processing challenges that had to be overcome in order to produce chill projections with state-of-the-art methodology.</a></li>
<li class="chapter" data-level="5.2" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#outline-in-your-understanding-the-basic-steps-that-are-necessary-to-make-such-projections."><i class="fa fa-check"></i><b>5.2</b> Outline, in your understanding, the basic steps that are necessary to make such projections.</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html"><i class="fa fa-check"></i><b>6</b> Manual chill analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#write-a-basic-function-that-calculates-warm-hours-25c"><i class="fa fa-check"></i><b>6.1</b> Write a basic function that calculates warm hours (&gt;25°C)</a></li>
<li class="chapter" data-level="6.2" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#apply-this-function-to-the-winters_hours_gaps-dataset"><i class="fa fa-check"></i><b>6.2</b> Apply this function to the Winters_hours_gaps dataset</a></li>
<li class="chapter" data-level="6.3" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#extend-this-function-so-that-it-can-take-start-and-end-dates-as-inputs-and-sums-up-warm-hours-between-these-dates"><i class="fa fa-check"></i><b>6.3</b> Extend this function, so that it can take start and end dates as inputs and sums up warm hours between these dates</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chill-models.html"><a href="chill-models.html"><i class="fa fa-check"></i><b>7</b> Chill Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chill-models.html"><a href="chill-models.html#run-the-chilling-function-on-the-winters_hours_gap-dataset"><i class="fa fa-check"></i><b>7.1</b> Run the chilling() function on the Winters_hours_gap dataset</a></li>
<li class="chapter" data-level="7.2" data-path="chill-models.html"><a href="chill-models.html#create-your-own-temperature-weighting-chill-model-using-the-step_model-function."><i class="fa fa-check"></i><b>7.2</b> Create your own temperature-weighting chill model using the step_model() function.</a></li>
<li class="chapter" data-level="7.3" data-path="chill-models.html"><a href="chill-models.html#run-this-model-on-the-winters_hours_gaps-dataset-using-the-tempresponse-function."><i class="fa fa-check"></i><b>7.3</b> Run this model on the Winters_hours_gaps dataset using the tempResponse() function.</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html"><i class="fa fa-check"></i><b>8</b> Making hourly temperatures</a>
<ul>
<li class="chapter" data-level="8.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#choose-a-location-of-interest-find-out-its-latitude-and-produce-plots-of-daily-sunrise-sunset-and-daylength"><i class="fa fa-check"></i><b>8.1</b> Choose a location of interest, find out its latitude and produce plots of daily sunrise, sunset and daylength</a></li>
<li class="chapter" data-level="8.2" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#produce-an-hourly-dataset-based-on-idealized-daily-curves-for-the-ka_weather-dataset-included-in-chillr"><i class="fa fa-check"></i><b>8.2</b> Produce an hourly dataset, based on idealized daily curves, for the KA_weather dataset (included in chillR)</a></li>
<li class="chapter" data-level="8.3" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#produce-empirical-temperature-curve-parameters-for-the-winters_hours_gaps-dataset-and-use-them-to-predict-hourly-values-from-daily-temperatures-this-is-very-similar-to-the-example-above-but-please-make-sure-you-understand-whats-going-on"><i class="fa fa-check"></i><b>8.3</b> Produce empirical temperature curve parameters for the Winters_hours_gaps dataset, and use them to predict hourly values from daily temperatures (this is very similar to the example above, but please make sure you understand what’s going on)</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html"><i class="fa fa-check"></i><b>9</b> Getting temperature data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#choose-a-location-of-interest-and-find-the-25-closest-weather-stations-using-the-handle_gsod-function"><i class="fa fa-check"></i><b>9.1</b> Choose a location of interest and find the 25 closest weather stations using the handle_gsod function</a></li>
<li class="chapter" data-level="9.2" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#download-weather-data-for-the-most-promising-station-on-the-list"><i class="fa fa-check"></i><b>9.2</b> Download weather data for the most promising station on the list</a></li>
<li class="chapter" data-level="9.3" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#convert-the-weather-data-into-chillr-format"><i class="fa fa-check"></i><b>9.3</b> Convert the weather data into chillR format</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html"><i class="fa fa-check"></i><b>10</b> Filling gaps in temperature records</a>
<ul>
<li class="chapter" data-level="10.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#use-chillr-functions-to-find-out-how-many-gaps-you-have-in-this-dataset-even-if-you-have-none-please-still-follow-all-further-steps"><i class="fa fa-check"></i><b>10.1</b> Use chillR functions to find out how many gaps you have in this dataset (even if you have none, please still follow all further steps)</a></li>
<li class="chapter" data-level="10.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#create-a-list-of-the-25-closest-weather-stations-using-the-handle_gsod-function"><i class="fa fa-check"></i><b>10.2</b> Create a list of the 25 closest weather stations using the handle_gsod function</a></li>
<li class="chapter" data-level="10.3" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#identify-suitable-weather-stations-for-patching-gaps"><i class="fa fa-check"></i><b>10.3</b> Identify suitable weather stations for patching gaps</a></li>
<li class="chapter" data-level="10.4" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#download-weather-data-for-promising-stations-convert-them-to-chillr-format-and-compile-them-in-a-list"><i class="fa fa-check"></i><b>10.4</b> Download weather data for promising stations, convert them to chillR format and compile them in a list</a></li>
<li class="chapter" data-level="10.5" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#use-the-patch_daily_temperatures-function-to-fill-gaps"><i class="fa fa-check"></i><b>10.5</b> Use the patch_daily_temperatures function to fill gaps</a></li>
<li class="chapter" data-level="10.6" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#investigate-the-results---have-all-gaps-been-filled"><i class="fa fa-check"></i><b>10.6</b> Investigate the results - have all gaps been filled?</a></li>
<li class="chapter" data-level="10.7" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#if-necessary-repeat-until-you-have-a-dataset-you-can-work-with-in-further-analyses"><i class="fa fa-check"></i><b>10.7</b> If necessary, repeat until you have a dataset you can work with in further analyses</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html"><i class="fa fa-check"></i><b>11</b> Generating temperature scenarios</a>
<ul>
<li class="chapter" data-level="11.1" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#for-the-location-you-chose-for-your-earlier-analyses-use-chillrs-weather-generator-to-produce-100-years-of-synthetic-temperature-data."><i class="fa fa-check"></i><b>11.1</b> For the location you chose for your earlier analyses, use chillR’s weather generator to produce 100 years of synthetic temperature data.</a></li>
<li class="chapter" data-level="11.2" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#calculate-winter-chill-in-chill-portions-for-your-synthetic-weather-and-illustrate-your-results-as-histograms-and-cumulative-distributions."><i class="fa fa-check"></i><b>11.2</b> Calculate winter chill (in Chill Portions) for your synthetic weather, and illustrate your results as histograms and cumulative distributions.</a></li>
<li class="chapter" data-level="11.3" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#produce-similar-plots-for-the-number-of-freezing-hours-0c-in-april-or-october-if-your-site-is-in-the-southern-hemisphere-for-your-location-of-interest."><i class="fa fa-check"></i><b>11.3</b> Produce similar plots for the number of freezing hours (&lt;0°C) in April (or October, if your site is in the Southern Hemisphere) for your location of interest.</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="saving-and-loading-data.html"><a href="saving-and-loading-data.html"><i class="fa fa-check"></i><b>12</b> Saving and Loading Data</a></li>
<li class="chapter" data-level="13" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html"><i class="fa fa-check"></i><b>13</b> Historic temperature scenarios</a>
<ul>
<li class="chapter" data-level="13.1" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#for-the-location-you-chose-for-previous-exercises-produce-historic-temperature-scenarios-representing-several-years-of-the-historic-record-your-choice."><i class="fa fa-check"></i><b>13.1</b> For the location you chose for previous exercises, produce historic temperature scenarios representing several years of the historic record (your choice).</a></li>
<li class="chapter" data-level="13.2" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#produce-chill-distributions-for-these-scenarios-and-plot-them."><i class="fa fa-check"></i><b>13.2</b> Produce chill distributions for these scenarios and plot them.</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html"><i class="fa fa-check"></i><b>14</b> Future temperature scenarios</a>
<ul>
<li class="chapter" data-level="14.1" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#analyze-the-historic-and-future-impact-of-climate-change-on-three-agroclimatic-metrics-of-your-choice-for-the-location-youve-chosen-for-your-earlier-analyses."><i class="fa fa-check"></i><b>14.1</b> Analyze the historic and future impact of climate change on three agroclimatic metrics of your choice, for the location you’ve chosen for your earlier analyses.</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="plotting-future-scenarios.html"><a href="plotting-future-scenarios.html"><i class="fa fa-check"></i><b>15</b> Plotting future scenarios</a>
<ul>
<li class="chapter" data-level="15.1" data-path="plotting-future-scenarios.html"><a href="plotting-future-scenarios.html#produce-similar-plots-for-the-weather-station-you-selected-for-earlier-exercises."><i class="fa fa-check"></i><b>15.1</b> Produce similar plots for the weather station you selected for earlier exercises.</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="chill-model-comparison.html"><a href="chill-model-comparison.html"><i class="fa fa-check"></i><b>16</b> Chill model comparison</a>
<ul>
<li class="chapter" data-level="16.1" data-path="chill-model-comparison.html"><a href="chill-model-comparison.html#perform-a-similar-analysis-for-the-location-youve-chosen-for-your-exercises."><i class="fa fa-check"></i><b>16.1</b> Perform a similar analysis for the location you’ve chosen for your exercises.</a></li>
<li class="chapter" data-level="16.2" data-path="chill-model-comparison.html"><a href="chill-model-comparison.html#make-a-heat-map-illustrating-past-and-future-changes-in-safe-winter-chill-relative-to-a-past-scenario-for-the-13-chill-models-used-here."><i class="fa fa-check"></i><b>16.2</b> Make a heat map illustrating past and future changes in Safe Winter Chill, relative to a past scenario, for the 13 chill models used here.</a></li>
<li class="chapter" data-level="16.3" data-path="chill-model-comparison.html"><a href="chill-model-comparison.html#produce-an-animated-line-plot-of-your-results-summarizing-safe-winter-chill-across-all-the-gcms."><i class="fa fa-check"></i><b>16.3</b> Produce an animated line plot of your results (summarizing Safe Winter Chill across all the GCMs).</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="chill-model-comparison-1.html"><a href="chill-model-comparison-1.html"><i class="fa fa-check"></i><b>17</b> Chill model comparison</a>
<ul>
<li class="chapter" data-level="17.1" data-path="chill-model-comparison-1.html"><a href="chill-model-comparison-1.html#provide-a-brief-narrative-describing-what-p-hacking-is-and-why-this-is-a-problematic-approach-to-data-analysis."><i class="fa fa-check"></i><b>17.1</b> Provide a brief narrative describing what p-hacking is, and why this is a problematic approach to data analysis.</a></li>
<li class="chapter" data-level="17.2" data-path="chill-model-comparison-1.html"><a href="chill-model-comparison-1.html#provide-a-sketch-of-your-causal-understanding-of-the-relationship-between-temperature-and-bloom-dates."><i class="fa fa-check"></i><b>17.2</b> Provide a sketch of your causal understanding of the relationship between temperature and bloom dates.</a></li>
<li class="chapter" data-level="17.3" data-path="chill-model-comparison-1.html"><a href="chill-model-comparison-1.html#what-do-we-need-to-know-to-build-a-process-based-model-from-this"><i class="fa fa-check"></i><b>17.3</b> What do we need to know to build a process-based model from this?</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="delineating-temperature-response-phases-with-pls-regression.html"><a href="delineating-temperature-response-phases-with-pls-regression.html"><i class="fa fa-check"></i><b>18</b> Delineating temperature response phases with PLS regression</a>
<ul>
<li class="chapter" data-level="18.1" data-path="delineating-temperature-response-phases-with-pls-regression.html"><a href="delineating-temperature-response-phases-with-pls-regression.html#briefly-explain-why-you-shouldnt-take-the-results-of-a-pls-regression-analysis-between-temperature-and-phenology-at-face-value.-what-do-you-need-in-addition-in-order-to-make-sense-of-such-outputs"><i class="fa fa-check"></i><b>18.1</b> Briefly explain why you shouldn’t take the results of a PLS regression analysis between temperature and phenology at face value. What do you need in addition in order to make sense of such outputs?</a></li>
<li class="chapter" data-level="18.2" data-path="delineating-temperature-response-phases-with-pls-regression.html"><a href="delineating-temperature-response-phases-with-pls-regression.html#replicate-the-pls-analysis-for-the-roter-boskoop-dataset-that-you-used-in-a-previous-lesson."><i class="fa fa-check"></i><b>18.2</b> Replicate the PLS analysis for the Roter Boskoop dataset that you used in a previous lesson.</a></li>
<li class="chapter" data-level="18.3" data-path="delineating-temperature-response-phases-with-pls-regression.html"><a href="delineating-temperature-response-phases-with-pls-regression.html#write-down-your-thoughts-on-why-were-not-seeing-the-temperature-response-pattern-we-may-have-expected.-what-happened-to-the-chill-response"><i class="fa fa-check"></i><b>18.3</b> Write down your thoughts on why we’re not seeing the temperature response pattern we may have expected. What happened to the chill response?</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="successes-and-limitations-of-pls-regression-analysis.html"><a href="successes-and-limitations-of-pls-regression-analysis.html"><i class="fa fa-check"></i><b>19</b> Successes and limitations of PLS regression analysis</a>
<ul>
<li class="chapter" data-level="19.1" data-path="successes-and-limitations-of-pls-regression-analysis.html"><a href="successes-and-limitations-of-pls-regression-analysis.html#briefly-explain-in-what-climatic-settings-we-can-expect-pls-regression-to-detect-the-chilling-phase---and-in-what-settings-this-probably-wont-work."><i class="fa fa-check"></i><b>19.1</b> Briefly explain in what climatic settings we can expect PLS regression to detect the chilling phase - and in what settings this probably won’t work.</a></li>
<li class="chapter" data-level="19.2" data-path="successes-and-limitations-of-pls-regression-analysis.html"><a href="successes-and-limitations-of-pls-regression-analysis.html#how-could-we-overcome-this-problem"><i class="fa fa-check"></i><b>19.2</b> How could we overcome this problem?</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="pls-regression-with-agroclimatic-metrics.html"><a href="pls-regression-with-agroclimatic-metrics.html"><i class="fa fa-check"></i><b>20</b> PLS regression with agroclimatic metrics</a>
<ul>
<li class="chapter" data-level="20.1" data-path="pls-regression-with-agroclimatic-metrics.html"><a href="pls-regression-with-agroclimatic-metrics.html#repeat-the-pls_chill_force-procedure-for-the-roter-boskoop-dataset.-include-plots-of-daily-chill-and-heat-accumulation."><i class="fa fa-check"></i><b>20.1</b> Repeat the PLS_chill_force procedure for the ‘Roter Boskoop’ dataset. Include plots of daily chill and heat accumulation.</a></li>
<li class="chapter" data-level="20.2" data-path="pls-regression-with-agroclimatic-metrics.html"><a href="pls-regression-with-agroclimatic-metrics.html#run-pls_chill_force-analyses-for-all-three-major-chill-models.-delineate-your-best-estimates-of-chilling-and-forcing-phases-for-all-of-them."><i class="fa fa-check"></i><b>20.2</b> Run PLS_chill_force analyses for all three major chill models. Delineate your best estimates of chilling and forcing phases for all of them.</a></li>
<li class="chapter" data-level="20.3" data-path="pls-regression-with-agroclimatic-metrics.html"><a href="pls-regression-with-agroclimatic-metrics.html#plot-results-for-all-three-analyses-including-shaded-plot-areas-for-the-chilling-and-forcing-periods-you-estimated."><i class="fa fa-check"></i><b>20.3</b> Plot results for all three analyses, including shaded plot areas for the chilling and forcing periods you estimated.</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="examples-of-pls-regression-with-agroclimatic-metrics.html"><a href="examples-of-pls-regression-with-agroclimatic-metrics.html"><i class="fa fa-check"></i><b>21</b> Examples of PLS regression with agroclimatic metrics</a>
<ul>
<li class="chapter" data-level="21.1" data-path="examples-of-pls-regression-with-agroclimatic-metrics.html"><a href="examples-of-pls-regression-with-agroclimatic-metrics.html#look-across-all-the-pls-results-presented-above.-can-you-detect-a-pattern-in-where-chilling-and-forcing-periods-could-be-delineated-clearly-and-where-this-attempt-failed"><i class="fa fa-check"></i><b>21.1</b> Look across all the PLS results presented above. Can you detect a pattern in where chilling and forcing periods could be delineated clearly, and where this attempt failed?</a></li>
<li class="chapter" data-level="21.2" data-path="examples-of-pls-regression-with-agroclimatic-metrics.html"><a href="examples-of-pls-regression-with-agroclimatic-metrics.html#can-you-think-about-possible-reasons-for-the-success-or-failure-of-pls-analysis-based-on-agroclimatic-metrics-if-so-write-down-your-thoughts"><i class="fa fa-check"></i><b>21.2</b> Can you think about possible reasons for the success or failure of PLS analysis based on agroclimatic metrics (if so, write down your thoughts)?</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="why-pls-doesnt-always-work.html"><a href="why-pls-doesnt-always-work.html"><i class="fa fa-check"></i><b>22</b> Why PLS doesn’t always work</a>
<ul>
<li class="chapter" data-level="22.1" data-path="why-pls-doesnt-always-work.html"><a href="why-pls-doesnt-always-work.html#produce-chill-and-heat-model-sensitivity-plots-for-the-location-you-focused-on-in-previous-exercises."><i class="fa fa-check"></i><b>22.1</b> Produce chill and heat model sensitivity plots for the location you focused on in previous exercises.</a></li>
<li class="chapter" data-level="22.2" data-path="why-pls-doesnt-always-work.html"><a href="why-pls-doesnt-always-work.html#look-at-the-plots-for-the-agroclimate-based-pls-analyses-of-the-alexander-lucas-and-roter-boskoop-datasets.-provide-your-best-estimates-of-the-chilling-and-forcing-phases."><i class="fa fa-check"></i><b>22.2</b> Look at the plots for the agroclimate-based PLS analyses of the ‘Alexander Lucas’ and ‘Roter Boskoop’ datasets. Provide your best estimates of the chilling and forcing phases.</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="evaluating-pls-outputs.html"><a href="evaluating-pls-outputs.html"><i class="fa fa-check"></i><b>23</b> Evaluating PLS outputs</a>
<ul>
<li class="chapter" data-level="23.1" data-path="evaluating-pls-outputs.html"><a href="evaluating-pls-outputs.html#reproduce-the-analysis-for-the-roter-boskoop-dataset."><i class="fa fa-check"></i><b>23.1</b> Reproduce the analysis for the ‘Roter Boskoop’ dataset.</a></li>
<li class="chapter" data-level="23.2" data-path="evaluating-pls-outputs.html"><a href="evaluating-pls-outputs.html#weve-looked-at-data-from-a-number-of-locations-so-far.-how-would-you-expect-this-surface-plot-to-look-like-in-beijing-and-how-should-it-look-in-tunisia"><i class="fa fa-check"></i><b>23.2</b> We’ve looked at data from a number of locations so far. How would you expect this surface plot to look like in Beijing? And how should it look in Tunisia?</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="the-relative-importance-of-chill-and-heat.html"><a href="the-relative-importance-of-chill-and-heat.html"><i class="fa fa-check"></i><b>24</b> The relative importance of chill and heat</a>
<ul>
<li class="chapter" data-level="24.1" data-path="the-relative-importance-of-chill-and-heat.html"><a href="the-relative-importance-of-chill-and-heat.html#describe-the-temperature-response-hypothesis-outlined-in-this-chapter."><i class="fa fa-check"></i><b>24.1</b> Describe the temperature response hypothesis outlined in this chapter.</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="making-valid-tree-phenology-models.html"><a href="making-valid-tree-phenology-models.html"><i class="fa fa-check"></i><b>25</b> Making valid tree phenology models</a>
<ul>
<li class="chapter" data-level="25.1" data-path="making-valid-tree-phenology-models.html"><a href="making-valid-tree-phenology-models.html#explain-the-difference-between-output-validation-and-process-validation."><i class="fa fa-check"></i><b>25.1</b> Explain the difference between output validation and process validation.</a></li>
<li class="chapter" data-level="25.2" data-path="making-valid-tree-phenology-models.html"><a href="making-valid-tree-phenology-models.html#explain-what-a-validity-domain-is-and-why-it-is-important-to-consider-this-whenever-we-want-to-use-our-model-to-forecast-something."><i class="fa fa-check"></i><b>25.2</b> Explain what a validity domain is and why it is important to consider this whenever we want to use our model to forecast something.</a></li>
<li class="chapter" data-level="25.3" data-path="making-valid-tree-phenology-models.html"><a href="making-valid-tree-phenology-models.html#what-is-validation-for-purpose"><i class="fa fa-check"></i><b>25.3</b> What is validation for purpose?</a></li>
<li class="chapter" data-level="25.4" data-path="making-valid-tree-phenology-models.html"><a href="making-valid-tree-phenology-models.html#how-can-we-ensure-that-our-model-is-suitable-for-the-predictions-we-want-to-make"><i class="fa fa-check"></i><b>25.4</b> How can we ensure that our model is suitable for the predictions we want to make?</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="the-phenoflex-model.html"><a href="the-phenoflex-model.html"><i class="fa fa-check"></i><b>26</b> The PhenoFlex model</a>
<ul>
<li class="chapter" data-level="26.1" data-path="the-phenoflex-model.html"><a href="the-phenoflex-model.html#parameterize-the-phenoflex-model-for-roter-boskoop-apples."><i class="fa fa-check"></i><b>26.1</b> Parameterize the PhenoFlex model for `Roter Boskoop’ apples.</a></li>
<li class="chapter" data-level="26.2" data-path="the-phenoflex-model.html"><a href="the-phenoflex-model.html#produce-plots-of-predicted-vs.-observed-bloom-dates-and-distribution-of-prediction-errors."><i class="fa fa-check"></i><b>26.2</b> Produce plots of predicted vs. observed bloom dates and distribution of prediction errors.</a></li>
<li class="chapter" data-level="26.3" data-path="the-phenoflex-model.html"><a href="the-phenoflex-model.html#compute-the-model-performance-metrics-rmsep-rpiq-mean-error-and-mean-absolute-error."><i class="fa fa-check"></i><b>26.3</b> Compute the model performance metrics RMSEP, RPIQ, mean error and mean absolute error.</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="the-phenoflex-model---a-second-look.html"><a href="the-phenoflex-model---a-second-look.html"><i class="fa fa-check"></i><b>27</b> The PhenoFlex model - a second look</a>
<ul>
<li class="chapter" data-level="27.1" data-path="the-phenoflex-model---a-second-look.html"><a href="the-phenoflex-model---a-second-look.html#make-chill-and-heat-response-plots-for-the-alexander-lucas-phenoflex-model-for-the-location-you-did-the-earlier-analyses-for."><i class="fa fa-check"></i><b>27.1</b> Make chill and heat response plots for the ‘Alexander Lucas’ PhenoFlex model for the location you did the earlier analyses for.</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="can-we-improve-the-performance-of-phenoflex.html"><a href="can-we-improve-the-performance-of-phenoflex.html"><i class="fa fa-check"></i><b>28</b> Can we improve the performance of PhenoFlex?</a>
<ul>
<li class="chapter" data-level="28.1" data-path="can-we-improve-the-performance-of-phenoflex.html"><a href="can-we-improve-the-performance-of-phenoflex.html#what-was-the-objective-of-this-work"><i class="fa fa-check"></i><b>28.1</b> What was the objective of this work?</a></li>
<li class="chapter" data-level="28.2" data-path="can-we-improve-the-performance-of-phenoflex.html"><a href="can-we-improve-the-performance-of-phenoflex.html#what-was-the-main-conclusion"><i class="fa fa-check"></i><b>28.2</b> What was the main conclusion?</a></li>
<li class="chapter" data-level="28.3" data-path="can-we-improve-the-performance-of-phenoflex.html"><a href="can-we-improve-the-performance-of-phenoflex.html#what-experiments-could-we-conduct-to-test-the-hypothesis-that-emerged-at-the-end-of-the-conclusion"><i class="fa fa-check"></i><b>28.3</b> What experiments could we conduct to test the hypothesis that emerged at the end of the conclusion?</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html"><i class="fa fa-check"></i><b>29</b> Frost risk analysis</a>
<ul>
<li class="chapter" data-level="29.1" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#download-the-phenology-dataset-for-the-apple-cultivar-roter-boskoop-from-klein-altendorf."><i class="fa fa-check"></i><b>29.1</b> Download the phenology dataset for the apple cultivar Roter Boskoop from Klein-Altendorf.</a></li>
<li class="chapter" data-level="29.2" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#illustrate-the-development-of-the-bloom-period-over-the-duration-of-the-weather-record.-use-multiple-ways-to-show-this---feel-free-to-be-creative."><i class="fa fa-check"></i><b>29.2</b> Illustrate the development of the bloom period over the duration of the weather record. Use multiple ways to show this - feel free to be creative.</a></li>
<li class="chapter" data-level="29.3" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#evaluate-the-occurrence-of-frost-events-at-klein-altendorf-since-1958.-illustrate-this-in-a-plot."><i class="fa fa-check"></i><b>29.3</b> Evaluate the occurrence of frost events at Klein-Altendorf since 1958. Illustrate this in a plot.</a></li>
<li class="chapter" data-level="29.4" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#produce-an-illustration-of-the-relationship-between-spring-frost-events-and-the-bloom-period-of-roter-boskoop."><i class="fa fa-check"></i><b>29.4</b> Produce an illustration of the relationship between spring frost events and the bloom period of ‘Roter Boskoop.’</a></li>
<li class="chapter" data-level="29.5" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#evaluate-how-the-risk-of-spring-frost-for-this-cultivar-has-changed-over-time.-has-there-been-a-significant-trend"><i class="fa fa-check"></i><b>29.5</b> Evaluate how the risk of spring frost for this cultivar has changed over time. Has there been a significant trend?</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published by Julian Bauer with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tree phenology analysis with R - Logbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pls-regression-with-agroclimatic-metrics" class="section level1 hasAnchor" number="20">
<h1><span class="header-section-number">Chapter 20</span> PLS regression with agroclimatic metrics<a href="pls-regression-with-agroclimatic-metrics.html#pls-regression-with-agroclimatic-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="repeat-the-pls_chill_force-procedure-for-the-roter-boskoop-dataset.-include-plots-of-daily-chill-and-heat-accumulation." class="section level2 hasAnchor" number="20.1">
<h2><span class="header-section-number">20.1</span> Repeat the PLS_chill_force procedure for the ‘Roter Boskoop’ dataset. Include plots of daily chill and heat accumulation.<a href="pls-regression-with-agroclimatic-metrics.html#repeat-the-pls_chill_force-procedure-for-the-roter-boskoop-dataset.-include-plots-of-daily-chill-and-heat-accumulation." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chillR)</span>
<span id="cb78-2"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-4" aria-hidden="true" tabindex="-1"></a>temps<span class="ot">&lt;-</span><span class="fu">read_tab</span>(<span class="st">&quot;data/TMaxTMin1958-2019_patched.csv&quot;</span>)</span>
<span id="cb78-5"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-5" aria-hidden="true" tabindex="-1"></a>temps_hourly<span class="ot">&lt;-</span><span class="fu">stack_hourly_temps</span>(temps,<span class="at">latitude=</span><span class="fl">50.6</span>)</span>
<span id="cb78-6"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-7" aria-hidden="true" tabindex="-1"></a>daychill<span class="ot">&lt;-</span><span class="fu">daily_chill</span>(<span class="at">hourtemps=</span>temps_hourly,</span>
<span id="cb78-8"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">running_mean=</span><span class="dv">1</span>,</span>
<span id="cb78-9"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">models =</span> <span class="fu">list</span>(<span class="at">Chilling_Hours =</span> Chilling_Hours, <span class="at">Utah_Chill_Units =</span> Utah_Model,</span>
<span id="cb78-10"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Chill_Portions =</span> Dynamic_Model, <span class="at">GDH =</span> GDH))</span>
<span id="cb78-11"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-12" aria-hidden="true" tabindex="-1"></a>Boskoop <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/Roter_Boskoop_bloom_1958_2019.csv&quot;</span>)</span>
<span id="cb78-13"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-13" aria-hidden="true" tabindex="-1"></a>Boskoop_first <span class="ot">&lt;-</span> Boskoop[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb78-14"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-14" aria-hidden="true" tabindex="-1"></a>Boskoop_first[,<span class="st">&quot;Year&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">substr</span>(Boskoop_first<span class="sc">$</span>First_bloom,<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb78-15"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-15" aria-hidden="true" tabindex="-1"></a>Boskoop_first[,<span class="st">&quot;Month&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">substr</span>(Boskoop_first<span class="sc">$</span>First_bloom,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb78-16"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-16" aria-hidden="true" tabindex="-1"></a>Boskoop_first[,<span class="st">&quot;Day&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">substr</span>(Boskoop_first<span class="sc">$</span>First_bloom,<span class="dv">7</span>,<span class="dv">8</span>)</span>
<span id="cb78-17"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-17" aria-hidden="true" tabindex="-1"></a>Boskoop_first <span class="ot">&lt;-</span> <span class="fu">make_JDay</span>(Boskoop_first)</span>
<span id="cb78-18"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-18" aria-hidden="true" tabindex="-1"></a>Boskoop_first <span class="ot">&lt;-</span> Boskoop_first[,<span class="fu">c</span>(<span class="st">&quot;Pheno_year&quot;</span>,<span class="st">&quot;JDay&quot;</span>)]</span>
<span id="cb78-19"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Boskoop_first) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>,<span class="st">&quot;pheno&quot;</span>)</span>
<span id="cb78-20"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-21"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-21" aria-hidden="true" tabindex="-1"></a>plscf <span class="ot">&lt;-</span> <span class="fu">PLS_chill_force</span>(<span class="at">daily_chill_obj=</span>daychill,</span>
<span id="cb78-22"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">bio_data_frame=</span>Boskoop_first,</span>
<span id="cb78-23"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">split_month=</span><span class="dv">6</span>,</span>
<span id="cb78-24"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">chill_models =</span> <span class="st">&quot;Chill_Portions&quot;</span>,</span>
<span id="cb78-25"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">heat_models =</span> <span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb78-26"><a href="pls-regression-with-agroclimatic-metrics.html#cb78-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">runn_means =</span> <span class="dv">11</span>)</span></code></pre></div>
<table class=" lightable-paper lightable-hover" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; ">
<caption>
<span id="tab:unnamed-chunk-76">Table 20.1: </span>Extract of the coefficients from the PLS analysis
</caption>
<thead>
<tr>
<th style="text-align:right;">
Date
</th>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
JDay
</th>
<th style="text-align:right;">
Coef
</th>
<th style="text-align:right;">
VIP
</th>
<th style="text-align:right;">
MetricMean
</th>
<th style="text-align:right;">
MetricStdev
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
701
</td>
<td style="text-align:left;">
Chill
</td>
<td style="text-align:right;">
-183
</td>
<td style="text-align:right;">
0.1137146
</td>
<td style="text-align:right;">
1.061441
</td>
<td style="text-align:right;">
0.0559804
</td>
<td style="text-align:right;">
0.0965426
</td>
</tr>
<tr>
<td style="text-align:right;">
702
</td>
<td style="text-align:left;">
Chill
</td>
<td style="text-align:right;">
-182
</td>
<td style="text-align:right;">
0.1330927
</td>
<td style="text-align:right;">
1.182803
</td>
<td style="text-align:right;">
0.0563105
</td>
<td style="text-align:right;">
0.0997921
</td>
</tr>
<tr>
<td style="text-align:right;">
703
</td>
<td style="text-align:left;">
Chill
</td>
<td style="text-align:right;">
-181
</td>
<td style="text-align:right;">
0.1127799
</td>
<td style="text-align:right;">
1.077426
</td>
<td style="text-align:right;">
0.0532572
</td>
<td style="text-align:right;">
0.0956684
</td>
</tr>
<tr>
<td style="text-align:right;">
704
</td>
<td style="text-align:left;">
Chill
</td>
<td style="text-align:right;">
-180
</td>
<td style="text-align:right;">
0.1739338
</td>
<td style="text-align:right;">
1.333523
</td>
<td style="text-align:right;">
0.0486906
</td>
<td style="text-align:right;">
0.0866341
</td>
</tr>
<tr>
<td style="text-align:right;">
705
</td>
<td style="text-align:left;">
Chill
</td>
<td style="text-align:right;">
-179
</td>
<td style="text-align:right;">
0.0967065
</td>
<td style="text-align:right;">
1.121475
</td>
<td style="text-align:right;">
0.0425852
</td>
<td style="text-align:right;">
0.0815729
</td>
</tr>
<tr>
<td style="text-align:right;">
706
</td>
<td style="text-align:left;">
Chill
</td>
<td style="text-align:right;">
-178
</td>
<td style="text-align:right;">
0.0696730
</td>
<td style="text-align:right;">
1.085244
</td>
<td style="text-align:right;">
0.0397766
</td>
<td style="text-align:right;">
0.0802201
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-1" aria-hidden="true" tabindex="-1"></a>PLS_gg<span class="ot">&lt;-</span>plscf<span class="sc">$</span>Chill_Portions<span class="sc">$</span>GDH<span class="sc">$</span>PLS_summary</span>
<span id="cb79-2"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-2" aria-hidden="true" tabindex="-1"></a>PLS_gg[,<span class="st">&quot;Month&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">trunc</span>(PLS_gg<span class="sc">$</span>Date<span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb79-3"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-3" aria-hidden="true" tabindex="-1"></a>PLS_gg[,<span class="st">&quot;Day&quot;</span>] <span class="ot">&lt;-</span> PLS_gg<span class="sc">$</span>Date<span class="sc">-</span>PLS_gg<span class="sc">$</span>Month<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb79-4"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-4" aria-hidden="true" tabindex="-1"></a>PLS_gg[,<span class="st">&quot;Date&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">ISOdate</span>(<span class="dv">2002</span>,PLS_gg<span class="sc">$</span>Month,PLS_gg<span class="sc">$</span>Day)</span>
<span id="cb79-5"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-5" aria-hidden="true" tabindex="-1"></a>PLS_gg[<span class="fu">which</span>(PLS_gg<span class="sc">$</span>JDay<span class="sc">&lt;=</span><span class="dv">0</span>),<span class="st">&quot;Date&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb79-6"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb79-7"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-7" aria-hidden="true" tabindex="-1"></a>          PLS_gg<span class="sc">$</span>Month[<span class="fu">which</span>(PLS_gg<span class="sc">$</span>JDay<span class="sc">&lt;=</span><span class="dv">0</span>)],</span>
<span id="cb79-8"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-8" aria-hidden="true" tabindex="-1"></a>          PLS_gg<span class="sc">$</span>Day[<span class="fu">which</span>(PLS_gg<span class="sc">$</span>JDay<span class="sc">&lt;=</span><span class="dv">0</span>)])</span>
<span id="cb79-9"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-9" aria-hidden="true" tabindex="-1"></a>PLS_gg[,<span class="st">&quot;VIP_importance&quot;</span>] <span class="ot">&lt;-</span> PLS_gg<span class="sc">$</span>VIP<span class="sc">&gt;=</span><span class="fl">0.8</span></span>
<span id="cb79-10"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-10" aria-hidden="true" tabindex="-1"></a>PLS_gg[,<span class="st">&quot;VIP_Coeff&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sign</span>(PLS_gg<span class="sc">$</span>Coef)<span class="sc">*</span>PLS_gg<span class="sc">$</span>VIP_importance)</span>
<span id="cb79-11"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-12" aria-hidden="true" tabindex="-1"></a>chill_start_JDay<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">48</span> <span class="co">#!</span></span>
<span id="cb79-13"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-13" aria-hidden="true" tabindex="-1"></a>chill_end_JDay<span class="ot">&lt;-</span><span class="dv">72</span></span>
<span id="cb79-14"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-14" aria-hidden="true" tabindex="-1"></a>heat_start_JDay<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">8</span></span>
<span id="cb79-15"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-15" aria-hidden="true" tabindex="-1"></a>heat_end_JDay<span class="ot">&lt;-</span><span class="dv">110</span></span>
<span id="cb79-16"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-17"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-17" aria-hidden="true" tabindex="-1"></a>chill_start_date<span class="ot">&lt;-</span><span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>)<span class="sc">+</span>chill_start_JDay<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span></span>
<span id="cb79-18"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-18" aria-hidden="true" tabindex="-1"></a>chill_end_date<span class="ot">&lt;-</span><span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>)<span class="sc">+</span>chill_end_JDay<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span></span>
<span id="cb79-19"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-19" aria-hidden="true" tabindex="-1"></a>heat_start_date<span class="ot">&lt;-</span><span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>)<span class="sc">+</span>heat_start_JDay<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span></span>
<span id="cb79-20"><a href="pls-regression-with-agroclimatic-metrics.html#cb79-20" aria-hidden="true" tabindex="-1"></a>heat_end_date<span class="ot">&lt;-</span><span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>)<span class="sc">+</span>heat_end_JDay<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span></span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb80-2"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-3" aria-hidden="true" tabindex="-1"></a>temp_plot<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg,<span class="at">x=</span>Date) <span class="sc">+</span></span>
<span id="cb80-4"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb80-5"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmin =</span> chill_start_date,</span>
<span id="cb80-6"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmax =</span> chill_end_date,</span>
<span id="cb80-7"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb80-8"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb80-9"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-10"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb80-11"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmin =</span> heat_start_date,</span>
<span id="cb80-12"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmax =</span> heat_end_date,</span>
<span id="cb80-13"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb80-14"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb80-15"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-16"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb80-17"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmin =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb80-18"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-18" aria-hidden="true" tabindex="-1"></a>             <span class="fu">min</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>,</span>
<span id="cb80-19"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmax =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb80-20"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">max</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>,</span>
<span id="cb80-21"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb80-22"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb80-23"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-24"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb80-25"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-25" aria-hidden="true" tabindex="-1"></a>               <span class="fu">median</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>,</span>
<span id="cb80-26"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-27"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,</span>
<span id="cb80-28"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin=</span>MetricMean <span class="sc">-</span> MetricStdev ,</span>
<span id="cb80-29"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax=</span>MetricMean <span class="sc">+</span> MetricStdev ),</span>
<span id="cb80-30"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-31"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,</span>
<span id="cb80-32"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin=</span>MetricMean <span class="sc">-</span> MetricStdev <span class="sc">*</span> (VIP_Coeff<span class="sc">==-</span><span class="dv">1</span>),</span>
<span id="cb80-33"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax=</span>MetricMean <span class="sc">+</span> MetricStdev <span class="sc">*</span> (VIP_Coeff<span class="sc">==-</span><span class="dv">1</span>)),</span>
<span id="cb80-34"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-35"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,</span>
<span id="cb80-36"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-36" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin=</span>MetricMean <span class="sc">-</span> MetricStdev <span class="sc">*</span> (VIP_Coeff<span class="sc">==</span><span class="dv">1</span>),</span>
<span id="cb80-37"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-37" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax=</span>MetricMean <span class="sc">+</span> MetricStdev <span class="sc">*</span> (VIP_Coeff<span class="sc">==</span><span class="dv">1</span>)),</span>
<span id="cb80-38"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-38" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span><span class="st">&quot;dark green&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-39"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>MetricMean ))</span>
<span id="cb80-40"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-41"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-41" aria-hidden="true" tabindex="-1"></a>temp_plot<span class="ot">&lt;-</span> temp_plot <span class="sc">+</span></span>
<span id="cb80-42"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Type), <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>,</span>
<span id="cb80-43"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position=</span><span class="st">&quot;left&quot;</span>,</span>
<span id="cb80-44"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-44" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Type =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb80-45"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-45" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="at">Chill=</span><span class="st">&quot;Chill (CP)&quot;</span>,<span class="at">Heat=</span><span class="st">&quot;Heat (GDH)&quot;</span>)))) <span class="sc">+</span></span>
<span id="cb80-46"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Daily chill and heat accumulation rates&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-47"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb80-48"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-49"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb80-50"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">12</span>),</span>
<span id="cb80-51"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb80-52"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y=</span><span class="fu">element_blank</span>()</span>
<span id="cb80-53"><a href="pls-regression-with-agroclimatic-metrics.html#cb80-53" aria-hidden="true" tabindex="-1"></a>        )</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-79"></span>
<img src="_main_files/figure-html/unnamed-chunk-79-1.png" alt="Daily chill and heat accumulation rates plot as part for the final graph" width="672" />
<p class="caption">
Figure 20.1: Daily chill and heat accumulation rates plot as part for the final graph
</p>
</div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-1" aria-hidden="true" tabindex="-1"></a>VIP_plot<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg,<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>VIP)) <span class="sc">+</span></span>
<span id="cb81-2"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb81-3"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmin =</span> chill_start_date,</span>
<span id="cb81-4"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmax =</span> chill_end_date,</span>
<span id="cb81-5"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb81-6"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb81-7"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-8"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb81-9"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmin =</span> heat_start_date,</span>
<span id="cb81-10"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmax =</span> heat_end_date,</span>
<span id="cb81-11"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb81-12"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb81-13"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-14"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb81-15"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmin =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb81-16"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">min</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>,</span>
<span id="cb81-17"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmax =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb81-18"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-18" aria-hidden="true" tabindex="-1"></a>             <span class="fu">max</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>,</span>
<span id="cb81-19"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb81-20"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb81-21"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-22"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb81-23"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-23" aria-hidden="true" tabindex="-1"></a>               <span class="fu">median</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>,</span>
<span id="cb81-24"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-25"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&#39;identity&#39;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>VIP<span class="sc">&gt;</span><span class="fl">0.8</span>))</span>
<span id="cb81-26"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-27"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-27" aria-hidden="true" tabindex="-1"></a>VIP_plot <span class="ot">&lt;-</span> VIP_plot <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Type), <span class="at">scales=</span><span class="st">&quot;free&quot;</span>,</span>
<span id="cb81-28"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position=</span><span class="st">&quot;left&quot;</span>,</span>
<span id="cb81-29"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Type =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb81-30"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-30" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="at">Chill=</span><span class="st">&quot;VIP for chill&quot;</span>,<span class="at">Heat=</span><span class="st">&quot;VIP for heat&quot;</span>)))) <span class="sc">+</span></span>
<span id="cb81-31"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb81-32"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(plscf<span class="sc">$</span>Chill_Portions<span class="sc">$</span>GDH<span class="sc">$</span>PLS_summary<span class="sc">$</span>VIP))) <span class="sc">+</span></span>
<span id="cb81-33"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Variable Importance in the Projection (VIP) scores&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-34"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb81-35"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb81-36"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb81-37"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">12</span>),</span>
<span id="cb81-38"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb81-39"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y=</span><span class="fu">element_blank</span>()</span>
<span id="cb81-40"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-40" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb81-41"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-42"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-42" aria-hidden="true" tabindex="-1"></a>VIP_plot <span class="ot">&lt;-</span> VIP_plot <span class="sc">+</span></span>
<span id="cb81-43"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;VIP&quot;</span>, </span>
<span id="cb81-44"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-44" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt;0.8&quot;</span>, <span class="st">&quot;&gt;0.8&quot;</span>), </span>
<span id="cb81-45"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-45" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;FALSE&quot;</span><span class="ot">=</span><span class="st">&quot;grey&quot;</span>, <span class="st">&quot;TRUE&quot;</span><span class="ot">=</span><span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb81-46"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb81-47"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb81-48"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb81-49"><a href="pls-regression-with-agroclimatic-metrics.html#cb81-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-81"></span>
<img src="_main_files/figure-html/unnamed-chunk-81-1.png" alt="VIP scores plotted and used as part for the final graph" width="672" />
<p class="caption">
Figure 20.2: VIP scores plotted and used as part for the final graph
</p>
</div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-1" aria-hidden="true" tabindex="-1"></a>coeff_plot<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg,<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>Coef)) <span class="sc">+</span></span>
<span id="cb82-2"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb82-3"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmin =</span> chill_start_date,</span>
<span id="cb82-4"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmax =</span> chill_end_date,</span>
<span id="cb82-5"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb82-6"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb82-7"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-8"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb82-9"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmin =</span> heat_start_date,</span>
<span id="cb82-10"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmax =</span> heat_end_date,</span>
<span id="cb82-11"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb82-12"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb82-13"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-14"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb82-15"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmin =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb82-16"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">min</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>,</span>
<span id="cb82-17"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmax =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb82-18"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-18" aria-hidden="true" tabindex="-1"></a>             <span class="fu">max</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>,</span>
<span id="cb82-19"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb82-20"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb82-21"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-22"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb82-23"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-23" aria-hidden="true" tabindex="-1"></a>               <span class="fu">median</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>,</span>
<span id="cb82-24"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-25"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&#39;identity&#39;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>VIP_Coeff))</span>
<span id="cb82-26"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-27"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-27" aria-hidden="true" tabindex="-1"></a>coeff_plot <span class="ot">&lt;-</span> coeff_plot <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Type), <span class="at">scales=</span><span class="st">&quot;free&quot;</span>,</span>
<span id="cb82-28"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position=</span><span class="st">&quot;left&quot;</span>,</span>
<span id="cb82-29"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb82-30"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">Type =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb82-31"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-31" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="at">Chill=</span><span class="st">&quot;MC for chill&quot;</span>,<span class="at">Heat=</span><span class="st">&quot;MC for heat&quot;</span>)))) <span class="sc">+</span></span>
<span id="cb82-32"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb82-33"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits=</span><span class="fu">c</span>(<span class="fu">min</span>(plscf<span class="sc">$</span>Chill_Portions<span class="sc">$</span>GDH<span class="sc">$</span>PLS_summary<span class="sc">$</span>Coef),</span>
<span id="cb82-34"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-34" aria-hidden="true" tabindex="-1"></a>             <span class="fu">max</span>(plscf<span class="sc">$</span>Chill_Portions<span class="sc">$</span>GDH<span class="sc">$</span>PLS_summary<span class="sc">$</span>Coef))) <span class="sc">+</span></span>
<span id="cb82-35"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Model coefficients (MC)&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-36"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb82-37"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb82-38"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb82-39"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">12</span>),</span>
<span id="cb82-40"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb82-41"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y=</span><span class="fu">element_blank</span>()</span>
<span id="cb82-42"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-42" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb82-43"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-44"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-44" aria-hidden="true" tabindex="-1"></a>coeff_plot <span class="ot">&lt;-</span> coeff_plot <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Type), <span class="at">scales=</span><span class="st">&quot;free&quot;</span>,</span>
<span id="cb82-45"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-45" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position=</span><span class="st">&quot;left&quot;</span>,</span>
<span id="cb82-46"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-46" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb82-47"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-47" aria-hidden="true" tabindex="-1"></a>               <span class="at">Type =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb82-48"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-48" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="at">Chill=</span><span class="st">&quot;MC for chill&quot;</span>,<span class="at">Heat=</span><span class="st">&quot;MC for heat&quot;</span>)))) <span class="sc">+</span></span>
<span id="cb82-49"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb82-50"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits=</span><span class="fu">c</span>(<span class="fu">min</span>(plscf<span class="sc">$</span>Chill_Portions<span class="sc">$</span>GDH<span class="sc">$</span>PLS_summary<span class="sc">$</span>Coef),</span>
<span id="cb82-51"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-51" aria-hidden="true" tabindex="-1"></a>             <span class="fu">max</span>(plscf<span class="sc">$</span>Chill_Portions<span class="sc">$</span>GDH<span class="sc">$</span>PLS_summary<span class="sc">$</span>Coef))) <span class="sc">+</span></span>
<span id="cb82-52"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Model coefficients (MC)&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-53"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb82-54"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb82-55"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb82-56"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">12</span>),</span>
<span id="cb82-57"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb82-58"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y=</span><span class="fu">element_blank</span>()</span>
<span id="cb82-59"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-59" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb82-60"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-61"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-61" aria-hidden="true" tabindex="-1"></a>coeff_plot <span class="ot">&lt;-</span> coeff_plot <span class="sc">+</span>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Effect direction&quot;</span>, </span>
<span id="cb82-62"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-62" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Advancing&quot;</span>, <span class="st">&quot;Unimportant&quot;</span>,<span class="st">&quot;Delaying&quot;</span>), </span>
<span id="cb82-63"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-63" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;-1&quot;</span><span class="ot">=</span><span class="st">&quot;red&quot;</span>, <span class="st">&quot;0&quot;</span><span class="ot">=</span><span class="st">&quot;grey&quot;</span>,<span class="st">&quot;1&quot;</span><span class="ot">=</span><span class="st">&quot;dark green&quot;</span>)) <span class="sc">+</span></span>
<span id="cb82-64"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;PLS coefficient&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-65"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb82-66"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb82-67"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb82-68"><a href="pls-regression-with-agroclimatic-metrics.html#cb82-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-83"></span>
<img src="_main_files/figure-html/unnamed-chunk-83-1.png" alt="Model coefficients plotted for the use in the final graph" width="672" />
<p class="caption">
Figure 20.3: Model coefficients plotted for the use in the final graph
</p>
</div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="pls-regression-with-agroclimatic-metrics.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb83-2"><a href="pls-regression-with-agroclimatic-metrics.html#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="pls-regression-with-agroclimatic-metrics.html#cb83-3" aria-hidden="true" tabindex="-1"></a>plot<span class="ot">&lt;-</span> (VIP_plot <span class="sc">+</span></span>
<span id="cb83-4"><a href="pls-regression-with-agroclimatic-metrics.html#cb83-4" aria-hidden="true" tabindex="-1"></a>          coeff_plot <span class="sc">+</span></span>
<span id="cb83-5"><a href="pls-regression-with-agroclimatic-metrics.html#cb83-5" aria-hidden="true" tabindex="-1"></a>          temp_plot <span class="sc">+</span></span>
<span id="cb83-6"><a href="pls-regression-with-agroclimatic-metrics.html#cb83-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plot_layout</span>(<span class="at">ncol=</span><span class="dv">1</span>,</span>
<span id="cb83-7"><a href="pls-regression-with-agroclimatic-metrics.html#cb83-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>)</span>
<span id="cb83-8"><a href="pls-regression-with-agroclimatic-metrics.html#cb83-8" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb83-9"><a href="pls-regression-with-agroclimatic-metrics.html#cb83-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb83-10"><a href="pls-regression-with-agroclimatic-metrics.html#cb83-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb83-11"><a href="pls-regression-with-agroclimatic-metrics.html#cb83-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">axis.title.x=</span><span class="fu">element_blank</span>())</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-85"></span>
<img src="_main_files/figure-html/unnamed-chunk-85-1.png" alt="Final result with all three subplots patched together" width="672" />
<p class="caption">
Figure 20.4: Final result with all three subplots patched together
</p>
</div>
I hid the code for the <code>plot_PLS_chill_force()</code> function behind the button below to save some space.<br />

<div id="spoiler" style="display:none">
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-1" aria-hidden="true" tabindex="-1"></a>plot_PLS_chill_force<span class="ot">&lt;-</span><span class="cf">function</span>(plscf,</span>
<span id="cb84-2"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chill_metric=</span><span class="st">&quot;Chill_Portions&quot;</span>,</span>
<span id="cb84-3"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">heat_metric=</span><span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb84-4"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chill_label=</span><span class="st">&quot;CP&quot;</span>,</span>
<span id="cb84-5"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">heat_label=</span><span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb84-6"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chill_phase=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">48</span>,<span class="dv">62</span>),</span>
<span id="cb84-7"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">heat_phase=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="fl">105.5</span>),</span>
<span id="cb84-8"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">plot_title=</span><span class="st">&quot; &quot;</span>)</span>
<span id="cb84-9"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-9" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb84-10"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-10" aria-hidden="true" tabindex="-1"></a>  PLS_gg<span class="ot">&lt;-</span>plscf[[chill_metric]][[heat_metric]]<span class="sc">$</span>PLS_summary</span>
<span id="cb84-11"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-11" aria-hidden="true" tabindex="-1"></a>  PLS_gg[,<span class="st">&quot;Month&quot;</span>]<span class="ot">&lt;-</span><span class="fu">trunc</span>(PLS_gg<span class="sc">$</span>Date<span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb84-12"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-12" aria-hidden="true" tabindex="-1"></a>  PLS_gg[,<span class="st">&quot;Day&quot;</span>]<span class="ot">&lt;-</span>PLS_gg<span class="sc">$</span>Date<span class="sc">-</span>PLS_gg<span class="sc">$</span>Month<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb84-13"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-13" aria-hidden="true" tabindex="-1"></a>  PLS_gg[,<span class="st">&quot;Date&quot;</span>]<span class="ot">&lt;-</span><span class="fu">ISOdate</span>(<span class="dv">2002</span>,PLS_gg<span class="sc">$</span>Month,PLS_gg<span class="sc">$</span>Day)</span>
<span id="cb84-14"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-14" aria-hidden="true" tabindex="-1"></a>  PLS_gg[<span class="fu">which</span>(PLS_gg<span class="sc">$</span>JDay<span class="sc">&lt;=</span><span class="dv">0</span>),<span class="st">&quot;Date&quot;</span>]<span class="ot">&lt;-</span><span class="fu">ISOdate</span>(<span class="dv">2001</span>,PLS_gg<span class="sc">$</span>Month[<span class="fu">which</span>(PLS_gg<span class="sc">$</span>JDay<span class="sc">&lt;=</span><span class="dv">0</span>)],PLS_gg<span class="sc">$</span>Day[<span class="fu">which</span>(PLS_gg<span class="sc">$</span>JDay<span class="sc">&lt;=</span><span class="dv">0</span>)])</span>
<span id="cb84-15"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-15" aria-hidden="true" tabindex="-1"></a>  PLS_gg[,<span class="st">&quot;VIP_importance&quot;</span>]<span class="ot">&lt;-</span>PLS_gg<span class="sc">$</span>VIP<span class="sc">&gt;=</span><span class="fl">0.8</span></span>
<span id="cb84-16"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-16" aria-hidden="true" tabindex="-1"></a>  PLS_gg[,<span class="st">&quot;VIP_Coeff&quot;</span>]<span class="ot">&lt;-</span><span class="fu">factor</span>(<span class="fu">sign</span>(PLS_gg<span class="sc">$</span>Coef)<span class="sc">*</span>PLS_gg<span class="sc">$</span>VIP_importance)</span>
<span id="cb84-17"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-18"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-18" aria-hidden="true" tabindex="-1"></a>  chill_start_date<span class="ot">&lt;-</span><span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>)<span class="sc">+</span>chill_phase[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span></span>
<span id="cb84-19"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-19" aria-hidden="true" tabindex="-1"></a>  chill_end_date<span class="ot">&lt;-</span><span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>)<span class="sc">+</span>chill_phase[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span></span>
<span id="cb84-20"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-20" aria-hidden="true" tabindex="-1"></a>  heat_start_date<span class="ot">&lt;-</span><span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>)<span class="sc">+</span>heat_phase[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span></span>
<span id="cb84-21"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-21" aria-hidden="true" tabindex="-1"></a>  heat_end_date<span class="ot">&lt;-</span><span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>)<span class="sc">+</span>heat_phase[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span></span>
<span id="cb84-22"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-23"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-24"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-24" aria-hidden="true" tabindex="-1"></a>  temp_plot<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg) <span class="sc">+</span></span>
<span id="cb84-25"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb84-26"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmin =</span> chill_start_date,</span>
<span id="cb84-27"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmax =</span> chill_end_date,</span>
<span id="cb84-28"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb84-29"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb84-30"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-31"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb84-32"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmin =</span> heat_start_date,</span>
<span id="cb84-33"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmax =</span> heat_end_date,</span>
<span id="cb84-34"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb84-35"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb84-36"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-37"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb84-38"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmin =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span> <span class="fu">min</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>,</span>
<span id="cb84-39"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmax =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span> <span class="fu">max</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>,</span>
<span id="cb84-40"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-40" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb84-41"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-41" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb84-42"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-42" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-43"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span> <span class="fu">median</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-44"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,</span>
<span id="cb84-45"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-45" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin=</span>MetricMean <span class="sc">-</span> MetricStdev ,</span>
<span id="cb84-46"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-46" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax=</span>MetricMean <span class="sc">+</span> MetricStdev ),</span>
<span id="cb84-47"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-47" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-48"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,</span>
<span id="cb84-49"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-49" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin=</span>MetricMean <span class="sc">-</span> MetricStdev <span class="sc">*</span> (VIP_Coeff<span class="sc">==-</span><span class="dv">1</span>),</span>
<span id="cb84-50"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-50" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax=</span>MetricMean <span class="sc">+</span> MetricStdev <span class="sc">*</span> (VIP_Coeff<span class="sc">==-</span><span class="dv">1</span>)),</span>
<span id="cb84-51"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-51" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-52"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,</span>
<span id="cb84-53"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-53" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin=</span>MetricMean <span class="sc">-</span> MetricStdev <span class="sc">*</span> (VIP_Coeff<span class="sc">==</span><span class="dv">1</span>),</span>
<span id="cb84-54"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-54" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax=</span>MetricMean <span class="sc">+</span> MetricStdev <span class="sc">*</span> (VIP_Coeff<span class="sc">==</span><span class="dv">1</span>)),</span>
<span id="cb84-55"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-55" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill=</span><span class="st">&quot;dark green&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-56"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>MetricMean )) <span class="sc">+</span></span>
<span id="cb84-57"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Type), <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>,</span>
<span id="cb84-58"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-58" aria-hidden="true" tabindex="-1"></a>               <span class="at">strip.position=</span><span class="st">&quot;left&quot;</span>,</span>
<span id="cb84-59"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-59" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Type =</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="at">Chill=</span><span class="fu">paste0</span>(<span class="st">&quot;Chill (&quot;</span>,chill_label,<span class="st">&quot;)&quot;</span>),<span class="at">Heat=</span><span class="fu">paste0</span>(<span class="st">&quot;Heat (&quot;</span>,heat_label,<span class="st">&quot;)&quot;</span>)) )) ) <span class="sc">+</span></span>
<span id="cb84-60"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Daily chill and heat accumulation rates&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-61"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb84-62"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-63"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-63" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb84-64"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-64" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">12</span>),</span>
<span id="cb84-65"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-65" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb84-66"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-66" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y=</span><span class="fu">element_blank</span>()</span>
<span id="cb84-67"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-67" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb84-68"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-69"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-69" aria-hidden="true" tabindex="-1"></a>  VIP_plot<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg,<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>VIP)) <span class="sc">+</span></span>
<span id="cb84-70"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb84-71"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-71" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmin =</span> chill_start_date,</span>
<span id="cb84-72"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-72" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmax =</span> chill_end_date,</span>
<span id="cb84-73"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-73" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb84-74"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-74" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb84-75"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-75" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-76"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb84-77"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-77" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmin =</span> heat_start_date,</span>
<span id="cb84-78"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-78" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmax =</span> heat_end_date,</span>
<span id="cb84-79"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-79" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb84-80"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-80" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb84-81"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-81" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-82"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb84-83"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-83" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmin =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span> <span class="fu">min</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>,</span>
<span id="cb84-84"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-84" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmax =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span> <span class="fu">max</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>,</span>
<span id="cb84-85"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-85" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb84-86"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-86" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb84-87"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-87" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-88"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span> <span class="fu">median</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-89"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&#39;identity&#39;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>VIP<span class="sc">&gt;</span><span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb84-90"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Type), <span class="at">scales=</span><span class="st">&quot;free&quot;</span>,</span>
<span id="cb84-91"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-91" aria-hidden="true" tabindex="-1"></a>               <span class="at">strip.position=</span><span class="st">&quot;left&quot;</span>,</span>
<span id="cb84-92"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-92" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Type =</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="at">Chill=</span><span class="st">&quot;VIP for chill&quot;</span>,<span class="at">Heat=</span><span class="st">&quot;VIP for heat&quot;</span>) )) ) <span class="sc">+</span></span>
<span id="cb84-93"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(plscf[[chill_metric]][[heat_metric]]<span class="sc">$</span>PLS_summary<span class="sc">$</span>VIP))) <span class="sc">+</span></span>
<span id="cb84-94"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Variable Importance in the Projection (VIP) scores&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-95"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb84-96"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-97"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-97" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb84-98"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-98" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">12</span>),</span>
<span id="cb84-99"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-99" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb84-100"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-100" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y=</span><span class="fu">element_blank</span>()</span>
<span id="cb84-101"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-101" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">+</span></span>
<span id="cb84-102"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;VIP&quot;</span>, </span>
<span id="cb84-103"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-103" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt;0.8&quot;</span>, <span class="st">&quot;&gt;0.8&quot;</span>), </span>
<span id="cb84-104"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-104" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;FALSE&quot;</span><span class="ot">=</span><span class="st">&quot;grey&quot;</span>, <span class="st">&quot;TRUE&quot;</span><span class="ot">=</span><span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb84-105"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-106"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-106" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-107"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-107" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-108"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-108" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb84-109"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-109" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-110"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-110" aria-hidden="true" tabindex="-1"></a>  coeff_plot<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg,<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>Coef)) <span class="sc">+</span></span>
<span id="cb84-111"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb84-112"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-112" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmin =</span> chill_start_date,</span>
<span id="cb84-113"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-113" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmax =</span> chill_end_date,</span>
<span id="cb84-114"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-114" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb84-115"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-115" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb84-116"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-116" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-117"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb84-118"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-118" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmin =</span> heat_start_date,</span>
<span id="cb84-119"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-119" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmax =</span> heat_end_date,</span>
<span id="cb84-120"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-120" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb84-121"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-121" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb84-122"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-122" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-123"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-123" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb84-124"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-124" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmin =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span> <span class="fu">min</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>,</span>
<span id="cb84-125"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-125" aria-hidden="true" tabindex="-1"></a>             <span class="at">xmax =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span> <span class="fu">max</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>,</span>
<span id="cb84-126"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-126" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb84-127"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-127" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb84-128"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-128" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-129"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,<span class="dv">12</span>,<span class="dv">31</span>) <span class="sc">+</span> <span class="fu">median</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">3600</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-130"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-130" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&#39;identity&#39;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>VIP_Coeff)) <span class="sc">+</span></span>
<span id="cb84-131"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-131" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Type), <span class="at">scales=</span><span class="st">&quot;free&quot;</span>,</span>
<span id="cb84-132"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-132" aria-hidden="true" tabindex="-1"></a>               <span class="at">strip.position=</span><span class="st">&quot;left&quot;</span>,</span>
<span id="cb84-133"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-133" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Type =</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="at">Chill=</span><span class="st">&quot;MC for chill&quot;</span>,<span class="at">Heat=</span><span class="st">&quot;MC for heat&quot;</span>) )) ) <span class="sc">+</span></span>
<span id="cb84-134"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-134" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="fu">min</span>(plscf[[chill_metric]][[heat_metric]]<span class="sc">$</span>PLS_summary<span class="sc">$</span>Coef),</span>
<span id="cb84-135"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-135" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">max</span>(plscf[[chill_metric]][[heat_metric]]<span class="sc">$</span>PLS_summary<span class="sc">$</span>Coef))) <span class="sc">+</span></span>
<span id="cb84-136"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Model coefficients (MC)&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-137"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb84-138"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-139"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-139" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb84-140"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-140" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">12</span>),</span>
<span id="cb84-141"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-141" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb84-142"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-142" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y=</span><span class="fu">element_blank</span>()</span>
<span id="cb84-143"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-143" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">+</span></span>
<span id="cb84-144"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-144" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Effect direction&quot;</span>, </span>
<span id="cb84-145"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-145" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Advancing&quot;</span>, <span class="st">&quot;Unimportant&quot;</span>,<span class="st">&quot;Delaying&quot;</span>), </span>
<span id="cb84-146"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-146" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;-1&quot;</span><span class="ot">=</span><span class="st">&quot;red&quot;</span>, <span class="st">&quot;0&quot;</span><span class="ot">=</span><span class="st">&quot;grey&quot;</span>,<span class="st">&quot;1&quot;</span><span class="ot">=</span><span class="st">&quot;dark green&quot;</span>)) <span class="sc">+</span></span>
<span id="cb84-147"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-147" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;PLS coefficient&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-148"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-148" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-149"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-149" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-150"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-150" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-151"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-151" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb84-152"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-152" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-153"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb84-154"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-154" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-155"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-155" aria-hidden="true" tabindex="-1"></a>  plot<span class="ot">&lt;-</span> (VIP_plot <span class="sc">+</span></span>
<span id="cb84-156"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-156" aria-hidden="true" tabindex="-1"></a>            coeff_plot <span class="sc">+</span></span>
<span id="cb84-157"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-157" aria-hidden="true" tabindex="-1"></a>            temp_plot <span class="sc">+</span></span>
<span id="cb84-158"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-158" aria-hidden="true" tabindex="-1"></a>            <span class="fu">plot_layout</span>(<span class="at">ncol=</span><span class="dv">1</span>,</span>
<span id="cb84-159"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-159" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>)) <span class="sc">+</span></span>
<span id="cb84-160"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-160" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb84-161"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-161" aria-hidden="true" tabindex="-1"></a>                    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb84-162"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-162" aria-hidden="true" tabindex="-1"></a>                    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb84-163"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-163" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.title.x=</span><span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb84-164"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-164" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plot_annotation</span>(<span class="at">title =</span> plot_title)</span>
<span id="cb84-165"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-166"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-166" aria-hidden="true" tabindex="-1"></a>plot</span>
<span id="cb84-167"><a href="pls-regression-with-agroclimatic-metrics.html#cb84-167" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<button title="Click to show/hide the code for the modified function" type="button" onclick="if(document.getElementById(&#39;spoiler&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;spoiler&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;spoiler&#39;) .style.display=&#39;none&#39;}">
Show/Hide code
</button>
<p><br />
</p>
</div>
<div id="run-pls_chill_force-analyses-for-all-three-major-chill-models.-delineate-your-best-estimates-of-chilling-and-forcing-phases-for-all-of-them." class="section level2 hasAnchor" number="20.2">
<h2><span class="header-section-number">20.2</span> Run PLS_chill_force analyses for all three major chill models. Delineate your best estimates of chilling and forcing phases for all of them.<a href="pls-regression-with-agroclimatic-metrics.html#run-pls_chill_force-analyses-for-all-three-major-chill-models.-delineate-your-best-estimates-of-chilling-and-forcing-phases-for-all-of-them." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="pls-regression-with-agroclimatic-metrics.html#cb85-1" aria-hidden="true" tabindex="-1"></a>daychill <span class="ot">&lt;-</span> <span class="fu">daily_chill</span>(<span class="at">hourtemps=</span>temps_hourly,</span>
<span id="cb85-2"><a href="pls-regression-with-agroclimatic-metrics.html#cb85-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">running_mean=</span><span class="dv">9</span>,</span>
<span id="cb85-3"><a href="pls-regression-with-agroclimatic-metrics.html#cb85-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">models =</span> <span class="fu">list</span>(<span class="at">Chilling_Hours =</span> Chilling_Hours,</span>
<span id="cb85-4"><a href="pls-regression-with-agroclimatic-metrics.html#cb85-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Utah_Chill_Units =</span> Utah_Model,</span>
<span id="cb85-5"><a href="pls-regression-with-agroclimatic-metrics.html#cb85-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Chill_Portions =</span> Dynamic_Model, <span class="at">GDH =</span> GDH)</span>
<span id="cb85-6"><a href="pls-regression-with-agroclimatic-metrics.html#cb85-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb85-7"><a href="pls-regression-with-agroclimatic-metrics.html#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="pls-regression-with-agroclimatic-metrics.html#cb85-8" aria-hidden="true" tabindex="-1"></a>plscf <span class="ot">&lt;-</span> <span class="fu">PLS_chill_force</span>(<span class="at">daily_chill_obj=</span>daychill,</span>
<span id="cb85-9"><a href="pls-regression-with-agroclimatic-metrics.html#cb85-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">bio_data_frame=</span>Boskoop_first,</span>
<span id="cb85-10"><a href="pls-regression-with-agroclimatic-metrics.html#cb85-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">split_month=</span><span class="dv">6</span>,</span>
<span id="cb85-11"><a href="pls-regression-with-agroclimatic-metrics.html#cb85-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">chill_models =</span> <span class="fu">c</span>(<span class="st">&quot;Chilling_Hours&quot;</span>,</span>
<span id="cb85-12"><a href="pls-regression-with-agroclimatic-metrics.html#cb85-12" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;Utah_Chill_Units&quot;</span>, <span class="st">&quot;Chill_Portions&quot;</span>),</span>
<span id="cb85-13"><a href="pls-regression-with-agroclimatic-metrics.html#cb85-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">heat_models =</span> <span class="fu">c</span>(<span class="st">&quot;GDH&quot;</span>))</span></code></pre></div>
<p>We can delineate the estimates of the chilling and forcing phases by having a direct look on the output of the PLS analysis another possibility is to estimate the phases with the help of the plotted version. <code>options(max.print=636)</code> allows to print the whole dataset, which had in this case 636 rows. The Coef and the VIP column contain the data that also the function uses for the plotting later. I prefer to use the plotted version of the data to delineate the phases, because this gives me a better overview over the longer development.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="pls-regression-with-agroclimatic-metrics.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">max.print=</span><span class="dv">636</span>)</span>
<span id="cb86-2"><a href="pls-regression-with-agroclimatic-metrics.html#cb86-2" aria-hidden="true" tabindex="-1"></a>plscf</span></code></pre></div>
<p>My estimated delineations are included in the table below. I wasnt able to delineate the chilling phase for the Chilling Hours model, because no model coefficients seemed to have an advancing effect. For both other models I was able to delineate the chilling period. For the GDH model, I set the delineation estimates once and did not change them, even though I observed slight changes in the advancing effects between the different chill models.</p>
<table class=" lightable-paper lightable-hover" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; ">
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="TRUE">
Chilling phase
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="TRUE">
Forcing phase
</div>
</th>
</tr>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
Start
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
End
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
Start
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
End
</div>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Chilling Hours
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
106
</td>
</tr>
<tr>
<td style="text-align:left;">
Utah Model
</td>
<td style="text-align:right;">
-13
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
106
</td>
</tr>
<tr>
<td style="text-align:left;">
Dynamic Model
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
106
</td>
</tr>
</tbody>
</table>
</div>
<div id="plot-results-for-all-three-analyses-including-shaded-plot-areas-for-the-chilling-and-forcing-periods-you-estimated." class="section level2 hasAnchor" number="20.3">
<h2><span class="header-section-number">20.3</span> Plot results for all three analyses, including shaded plot areas for the chilling and forcing periods you estimated.<a href="pls-regression-with-agroclimatic-metrics.html#plot-results-for-all-three-analyses-including-shaded-plot-areas-for-the-chilling-and-forcing-periods-you-estimated." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Below I plotted the estimated delineations together with the previously created function. For the Chilling Hours plot (as already mentioned above) no chilling period can be determined<br />
</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="pls-regression-with-agroclimatic-metrics.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_PLS_chill_force</span>(plscf,</span>
<span id="cb87-2"><a href="pls-regression-with-agroclimatic-metrics.html#cb87-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chill_metric=</span><span class="st">&quot;Chilling_Hours&quot;</span>,</span>
<span id="cb87-3"><a href="pls-regression-with-agroclimatic-metrics.html#cb87-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">heat_metric=</span><span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb87-4"><a href="pls-regression-with-agroclimatic-metrics.html#cb87-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chill_label=</span><span class="st">&quot;CH&quot;</span>,</span>
<span id="cb87-5"><a href="pls-regression-with-agroclimatic-metrics.html#cb87-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">heat_label=</span><span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb87-6"><a href="pls-regression-with-agroclimatic-metrics.html#cb87-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chill_phase=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb87-7"><a href="pls-regression-with-agroclimatic-metrics.html#cb87-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">heat_phase=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">106</span>),</span>
<span id="cb87-8"><a href="pls-regression-with-agroclimatic-metrics.html#cb87-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">plot_title =</span> <span class="st">&quot;Chilling Hours model&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-91"></span>
<img src="_main_files/figure-html/unnamed-chunk-91-1.png" alt="PLS regression plot for the response of the Chilling Hours model and GDH model for ‘Roter Boskoop’ apples at CKA" width="672" />
<p class="caption">
Figure 20.5: PLS regression plot for the response of the Chilling Hours model and GDH model for ‘Roter Boskoop’ apples at CKA
</p>
</div>
<p><br />
</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="pls-regression-with-agroclimatic-metrics.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_PLS_chill_force</span>(plscf,</span>
<span id="cb88-2"><a href="pls-regression-with-agroclimatic-metrics.html#cb88-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chill_metric=</span><span class="st">&quot;Utah_Chill_Units&quot;</span>,</span>
<span id="cb88-3"><a href="pls-regression-with-agroclimatic-metrics.html#cb88-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">heat_metric=</span><span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb88-4"><a href="pls-regression-with-agroclimatic-metrics.html#cb88-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chill_label=</span><span class="st">&quot;CU&quot;</span>,</span>
<span id="cb88-5"><a href="pls-regression-with-agroclimatic-metrics.html#cb88-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">heat_label=</span><span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb88-6"><a href="pls-regression-with-agroclimatic-metrics.html#cb88-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chill_phase=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">13</span>,<span class="dv">65</span>),</span>
<span id="cb88-7"><a href="pls-regression-with-agroclimatic-metrics.html#cb88-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">heat_phase=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">108</span>),</span>
<span id="cb88-8"><a href="pls-regression-with-agroclimatic-metrics.html#cb88-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">plot_title =</span> <span class="st">&quot;Utah Chill model&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-92"></span>
<img src="_main_files/figure-html/unnamed-chunk-92-1.png" alt="PLS regression plot for the response of the Utah Chill model and GDH model for ‘Roter Boskoop’ apples at CKA" width="672" />
<p class="caption">
Figure 20.6: PLS regression plot for the response of the Utah Chill model and GDH model for ‘Roter Boskoop’ apples at CKA
</p>
</div>
<p><br />
</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="pls-regression-with-agroclimatic-metrics.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_PLS_chill_force</span>(plscf,</span>
<span id="cb89-2"><a href="pls-regression-with-agroclimatic-metrics.html#cb89-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chill_metric=</span><span class="st">&quot;Chill_Portions&quot;</span>,</span>
<span id="cb89-3"><a href="pls-regression-with-agroclimatic-metrics.html#cb89-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">heat_metric=</span><span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb89-4"><a href="pls-regression-with-agroclimatic-metrics.html#cb89-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chill_label=</span><span class="st">&quot;CP&quot;</span>,</span>
<span id="cb89-5"><a href="pls-regression-with-agroclimatic-metrics.html#cb89-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">heat_label=</span><span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb89-6"><a href="pls-regression-with-agroclimatic-metrics.html#cb89-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chill_phase=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">24</span>,<span class="dv">62</span>),</span>
<span id="cb89-7"><a href="pls-regression-with-agroclimatic-metrics.html#cb89-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">heat_phase=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">108</span>),</span>
<span id="cb89-8"><a href="pls-regression-with-agroclimatic-metrics.html#cb89-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">plot_title =</span> <span class="st">&quot;Dynamic Model&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-93"></span>
<img src="_main_files/figure-html/unnamed-chunk-93-1.png" alt="PLS regression plot for the response of the Dynamic Model and GDH model for ‘Roter Boskoop’ apples at CKA" width="672" />
<p class="caption">
Figure 20.7: PLS regression plot for the response of the Dynamic Model and GDH model for ‘Roter Boskoop’ apples at CKA
</p>
</div>
<br />

<hr />

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="successes-and-limitations-of-pls-regression-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="examples-of-pls-regression-with-agroclimatic-metrics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/JNBauer/tree_pheno_modelling/20-pls_with_agroclimatic_metrics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"code_folding": "hide"
});
});
</script>

</body>

</html>
