<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Getting temperature data | Tree phenology analysis with R - Logbook</title>
  <meta name="description" content="The logbook for the Tree phenology analysis with R logbook" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Getting temperature data | Tree phenology analysis with R - Logbook" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="The logbook for the Tree phenology analysis with R logbook" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Getting temperature data | Tree phenology analysis with R - Logbook" />
  
  <meta name="twitter:description" content="The logbook for the Tree phenology analysis with R logbook" />
  

<meta name="author" content="Julian Bauer" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="making-hourly-temperatures.html"/>
<link rel="next" href="filling-gaps-in-temperature-records.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<link href="libs/leaflet-minimap-3.3.1/Control.MiniMap.min.css" rel="stylesheet" />
<script src="libs/leaflet-minimap-3.3.1/Control.MiniMap.min.js"></script>
<script src="libs/leaflet-minimap-3.3.1/Minimap-binding.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree phenology Logbook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="tools.html"><a href="tools.html"><i class="fa fa-check"></i><b>2</b> Tools</a></li>
<li class="chapter" data-level="3" data-path="tree-dormancy.html"><a href="tree-dormancy.html"><i class="fa fa-check"></i><b>3</b> Tree dormancy</a></li>
<li class="chapter" data-level="4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html"><i class="fa fa-check"></i><b>4</b> Climate change and impact projection</a></li>
<li class="chapter" data-level="5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html"><i class="fa fa-check"></i><b>5</b> Winter chill projections</a></li>
<li class="chapter" data-level="6" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html"><i class="fa fa-check"></i><b>6</b> Manual chill analysis</a></li>
<li class="chapter" data-level="7" data-path="chill-models.html"><a href="chill-models.html"><i class="fa fa-check"></i><b>7</b> Chill Models</a></li>
<li class="chapter" data-level="8" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html"><i class="fa fa-check"></i><b>8</b> Making hourly temperatures</a></li>
<li class="chapter" data-level="9" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html"><i class="fa fa-check"></i><b>9</b> Getting temperature data</a></li>
<li class="chapter" data-level="10" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html"><i class="fa fa-check"></i><b>10</b> Filling gaps in temperature records</a>
<ul>
<li class="chapter" data-level="10.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#use-chillr-functions-to-find-out-how-many-gaps-you-have-in-this-dataset-even-if-you-have-none-please-still-follow-all-further-steps"><i class="fa fa-check"></i><b>10.1</b> Use chillR functions to find out how many gaps you have in this dataset (even if you have none, please still follow all further steps)</a></li>
<li class="chapter" data-level="10.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#create-a-list-of-the-25-closest-weather-stations-using-the-handle_gsod-function"><i class="fa fa-check"></i><b>10.2</b> Create a list of the 25 closest weather stations using the handle_gsod function</a></li>
<li class="chapter" data-level="10.3" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#identify-suitable-weather-stations-for-patching-gaps"><i class="fa fa-check"></i><b>10.3</b> Identify suitable weather stations for patching gaps</a></li>
<li class="chapter" data-level="10.4" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#download-weather-data-for-promising-stations-convert-them-to-chillr-format-and-compile-them-in-a-list"><i class="fa fa-check"></i><b>10.4</b> Download weather data for promising stations, convert them to chillR format and compile them in a list</a></li>
<li class="chapter" data-level="10.5" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#use-the-patch_daily_temperatures-function-to-fill-gaps"><i class="fa fa-check"></i><b>10.5</b> Use the patch_daily_temperatures function to fill gaps</a></li>
<li class="chapter" data-level="10.6" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#investigate-the-results---have-all-gaps-been-filled"><i class="fa fa-check"></i><b>10.6</b> Investigate the results - have all gaps been filled?</a></li>
<li class="chapter" data-level="10.7" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#if-necessary-repeat-until-you-have-a-dataset-you-can-work-with-in-further-analyses"><i class="fa fa-check"></i><b>10.7</b> If necessary, repeat until you have a dataset you can work with in further analyses</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html"><i class="fa fa-check"></i><b>11</b> Generating temperature scenarios</a>
<ul>
<li class="chapter" data-level="11.1" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#for-the-location-you-chose-for-your-earlier-analyses-use-chillrs-weather-generator-to-produce-100-years-of-synthetic-temperature-data."><i class="fa fa-check"></i><b>11.1</b> For the location you chose for your earlier analyses, use chillR’s weather generator to produce 100 years of synthetic temperature data.</a></li>
<li class="chapter" data-level="11.2" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#calculate-winter-chill-in-chill-portions-for-your-synthetic-weather-and-illustrate-your-results-as-histograms-and-cumulative-distributions."><i class="fa fa-check"></i><b>11.2</b> Calculate winter chill (in Chill Portions) for your synthetic weather, and illustrate your results as histograms and cumulative distributions.</a></li>
<li class="chapter" data-level="11.3" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#produce-similar-plots-for-the-number-of-freezing-hours-0c-in-april-or-october-if-your-site-is-in-the-southern-hemisphere-for-your-location-of-interest."><i class="fa fa-check"></i><b>11.3</b> Produce similar plots for the number of freezing hours (&lt;0°C) in April (or October, if your site is in the Southern Hemisphere) for your location of interest.</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="saving-and-loading-data.html"><a href="saving-and-loading-data.html"><i class="fa fa-check"></i><b>12</b> Saving and Loading Data</a></li>
<li class="chapter" data-level="13" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html"><i class="fa fa-check"></i><b>13</b> Historic temperature scenarios</a></li>
<li class="chapter" data-level="14" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html"><i class="fa fa-check"></i><b>14</b> Future temperature scenarios</a></li>
<li class="chapter" data-level="15" data-path="plotting-future-scenarios.html"><a href="plotting-future-scenarios.html"><i class="fa fa-check"></i><b>15</b> Plotting future scenarios</a></li>
<li class="chapter" data-level="16" data-path="chill-model-comparison.html"><a href="chill-model-comparison.html"><i class="fa fa-check"></i><b>16</b> Chill model comparison</a></li>
<li class="chapter" data-level="17" data-path="chill-model-comparison-1.html"><a href="chill-model-comparison-1.html"><i class="fa fa-check"></i><b>17</b> Chill model comparison</a></li>
<li class="chapter" data-level="18" data-path="delineating-temperature-response-phases-with-pls-regression.html"><a href="delineating-temperature-response-phases-with-pls-regression.html"><i class="fa fa-check"></i><b>18</b> Delineating temperature response phases with PLS regression</a></li>
<li class="chapter" data-level="19" data-path="simple-phenology-analysis.html"><a href="simple-phenology-analysis.html"><i class="fa fa-check"></i><b>19</b> Simple phenology analysis</a></li>
<li class="chapter" data-level="20" data-path="pls-regression-with-agroclimatic-metrics.html"><a href="pls-regression-with-agroclimatic-metrics.html"><i class="fa fa-check"></i><b>20</b> PLS regression with agroclimatic metrics</a></li>
<li class="chapter" data-level="21" data-path="pls_evaluation.html"><a href="pls_evaluation.html"><i class="fa fa-check"></i><b>21</b> pls_evaluation</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tree phenology analysis with R - Logbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="getting-temperature-data" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Getting temperature data<a href="getting-temperature-data.html#getting-temperature-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><br />
## Choose a location of interest and find the 25 closest weather stations using the handle_gsod function</p>
<p>I chose a location in South Africa near Cape Town with a longitude of <code>18.8148</code> and a latitude of <code>-33.9575</code>, which can be seen in the leaflet below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="getting-temperature-data.html#cb1-1" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">18.8148</span>, <span class="sc">-</span><span class="fl">33.9575</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:goedvertrouw"></span>
<div id="htmlwidget-3d27422e59ad98c3a57d" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-3d27422e59ad98c3a57d">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"setView":[[-33.9575,18.8148],16,[]],"calls":[{"method":"addProviderTiles","args":["Esri.WorldImagery",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addMiniMap","args":[null,"Esri.WorldStreetMap","bottomright",150,150,19,19,-5,false,false,false,true,false,false,{"color":"#ff7800","weight":1,"clickable":false},{"color":"#000000","weight":1,"clickable":false,"opacity":0,"fillOpacity":0},{"hideText":"Hide MiniMap","showText":"Show MiniMap"},[]]},{"method":"addMarkers","args":[-33.9575,18.8148,null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-33.9575,-33.9575],"lng":[18.8148,18.8148]}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 9.1: A leaflet map that shows the selected location.
</p>
</div>
<p>The multi-functional <code>handle_gsod</code> function can be used to create a list of surrounding stations for a location of interest. The ten closest stations are shown in the list below and are also marked in the lower leaflet map. The apple marks the selected farm and the weather station icons symbolize the position of the stations.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="getting-temperature-data.html#cb2-1" aria-hidden="true" tabindex="-1"></a>station_list<span class="ot">&lt;-</span><span class="fu">handle_gsod</span>(<span class="at">action=</span><span class="st">&quot;list_stations&quot;</span>,</span>
<span id="cb2-2"><a href="getting-temperature-data.html#cb2-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">location=</span><span class="fu">c</span>(coords[<span class="dv">1</span>], coords[<span class="dv">2</span>]),</span>
<span id="cb2-3"><a href="getting-temperature-data.html#cb2-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">time_interval=</span><span class="fu">c</span>(<span class="dv">1977</span>,<span class="dv">2020</span>),</span>
<span id="cb2-4"><a href="getting-temperature-data.html#cb2-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">stations_to_choose_from =</span> <span class="dv">25</span>)</span></code></pre></div>
<table class=" lightable-paper lightable-hover" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; ">
<caption>
<span id="tab:unnamed-chunk-2">Table 9.1: </span>Table (shortened) for the <code>station_list</code>
</caption>
<thead>
<tr>
<th style="text-align:left;">
STATION.NAME
</th>
<th style="text-align:left;">
CTRY
</th>
<th style="text-align:right;">
Lat
</th>
<th style="text-align:right;">
Long
</th>
<th style="text-align:right;">
BEGIN
</th>
<th style="text-align:right;">
END
</th>
<th style="text-align:right;">
distance
</th>
<th style="text-align:right;">
Overlap_years
</th>
<th style="text-align:right;">
Perc_interval_covered
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
CAPE TOWN INTL
</td>
<td style="text-align:left;">
SF
</td>
<td style="text-align:right;">
-33.965
</td>
<td style="text-align:right;">
18.602
</td>
<td style="text-align:right;">
19490101
</td>
<td style="text-align:right;">
20221215
</td>
<td style="text-align:right;">
19.61
</td>
<td style="text-align:right;">
44.00
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:left;">
CT-AWS
</td>
<td style="text-align:left;">
SF
</td>
<td style="text-align:right;">
-33.967
</td>
<td style="text-align:right;">
18.600
</td>
<td style="text-align:right;">
20041102
</td>
<td style="text-align:right;">
20221215
</td>
<td style="text-align:right;">
19.81
</td>
<td style="text-align:right;">
16.16
</td>
<td style="text-align:right;">
36.73
</td>
</tr>
<tr>
<td style="text-align:left;">
STRAND
</td>
<td style="text-align:left;">
SF
</td>
<td style="text-align:right;">
-34.150
</td>
<td style="text-align:right;">
18.850
</td>
<td style="text-align:right;">
20040525
</td>
<td style="text-align:right;">
20220328
</td>
<td style="text-align:right;">
21.66
</td>
<td style="text-align:right;">
16.60
</td>
<td style="text-align:right;">
37.74
</td>
</tr>
<tr>
<td style="text-align:left;">
ELGIN EXP FARM
</td>
<td style="text-align:left;">
SF
</td>
<td style="text-align:right;">
-34.139
</td>
<td style="text-align:right;">
19.023
</td>
<td style="text-align:right;">
19980301
</td>
<td style="text-align:right;">
20221215
</td>
<td style="text-align:right;">
27.93
</td>
<td style="text-align:right;">
22.84
</td>
<td style="text-align:right;">
51.90
</td>
</tr>
<tr>
<td style="text-align:left;">
YSTERPLANT(SAAFB)
</td>
<td style="text-align:left;">
SF
</td>
<td style="text-align:right;">
-33.900
</td>
<td style="text-align:right;">
18.500
</td>
<td style="text-align:right;">
20040224
</td>
<td style="text-align:right;">
20201230
</td>
<td style="text-align:right;">
29.71
</td>
<td style="text-align:right;">
16.85
</td>
<td style="text-align:right;">
38.30
</td>
</tr>
<tr>
<td style="text-align:left;">
PAARL
</td>
<td style="text-align:left;">
SF
</td>
<td style="text-align:right;">
-33.717
</td>
<td style="text-align:right;">
18.967
</td>
<td style="text-align:right;">
20040608
</td>
<td style="text-align:right;">
20221215
</td>
<td style="text-align:right;">
30.15
</td>
<td style="text-align:right;">
16.57
</td>
<td style="text-align:right;">
37.65
</td>
</tr>
<tr>
<td style="text-align:left;">
CAPE TOWN - PORTNET
</td>
<td style="text-align:left;">
SF
</td>
<td style="text-align:right;">
-33.900
</td>
<td style="text-align:right;">
18.433
</td>
<td style="text-align:right;">
19980301
</td>
<td style="text-align:right;">
20221215
</td>
<td style="text-align:right;">
35.79
</td>
<td style="text-align:right;">
22.84
</td>
<td style="text-align:right;">
51.90
</td>
</tr>
<tr>
<td style="text-align:left;">
MOLTENO RESERVIOR
</td>
<td style="text-align:left;">
SF
</td>
<td style="text-align:right;">
-33.933
</td>
<td style="text-align:right;">
18.417
</td>
<td style="text-align:right;">
20131210
</td>
<td style="text-align:right;">
20221215
</td>
<td style="text-align:right;">
36.80
</td>
<td style="text-align:right;">
7.06
</td>
<td style="text-align:right;">
16.04
</td>
</tr>
<tr>
<td style="text-align:left;">
SIMONSTOWN
</td>
<td style="text-align:left;">
SF
</td>
<td style="text-align:right;">
-34.200
</td>
<td style="text-align:right;">
18.433
</td>
<td style="text-align:right;">
19490101
</td>
<td style="text-align:right;">
19500625
</td>
<td style="text-align:right;">
44.31
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
ROBBEN ISLAND
</td>
<td style="text-align:left;">
SF
</td>
<td style="text-align:right;">
-33.800
</td>
<td style="text-align:right;">
18.367
</td>
<td style="text-align:right;">
20041005
</td>
<td style="text-align:right;">
20221215
</td>
<td style="text-align:right;">
44.87
</td>
<td style="text-align:right;">
16.24
</td>
<td style="text-align:right;">
36.91
</td>
</tr>
</tbody>
</table>
<div id="htmlwidget-8f760cc5ee6369fb98bb" style="width:100%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-8f760cc5ee6369fb98bb">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,"Topographical map",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addProviderTiles","args":["Esri.WorldImagery",null,"World imagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addMarkers","args":[-33.9575,18.8148,{"iconUrl":{"data":"https://cdn-icons-png.flaticon.com/512/415/415682.png","index":0},"iconWidth":40,"iconHeight":40,"iconAnchorX":20,"iconAnchorY":20},{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}}},"width":"100%","height":null,"sizingPolicy":{"defaultWidth":"100%","defaultHeight":400,"padding":0,"viewer":{"defaultWidth":null,"defaultHeight":null,"padding":null,"fill":true,"suppress":false,"paneHeight":null},"browser":{"defaultWidth":null,"defaultHeight":null,"padding":null,"fill":true,"external":false},"knitr":{"defaultWidth":null,"defaultHeight":null,"figure":true}},"dependencies":null,"elementId":null,"preRenderHook":["function (widget) ","{","    if (!is.null(widget$jsHooks$render)) {","        widget$jsHooks$render <- lapply(widget$jsHooks$render, ","            function(hook) {","                if (is.list(hook)) {","                  hook$code <- sprintf(hookWrapperTemplate, paste(hook$code, ","                    collapse = \"\\n\"))","                }","                else if (is.character(hook)) {","                  hook <- sprintf(hookWrapperTemplate, paste(hook, ","                    collapse = \"\\n\"))","                }","                else {","                  stop(\"Unknown hook class \", class(hook))","                }","                hook","            })","    }","    widget","}"],"jsHooks":[]},null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Center",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[["Topographical map","World imagery"],[],{"collapsed":false,"autoZIndex":true,"position":"topright"}]},{"method":"addMarkers","args":[-33.965,18.602,{"iconUrl":{"data":"https://cdn-icons-png.flaticon.com/512/1753/1753451.png","index":0},"iconWidth":30,"iconHeight":30,"iconAnchorX":15,"iconAnchorY":15},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"CAPE TOWN INTL",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[-33.967,18.6,{"iconUrl":{"data":"https://cdn-icons-png.flaticon.com/512/1753/1753451.png","index":0},"iconWidth":30,"iconHeight":30,"iconAnchorX":15,"iconAnchorY":15},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"CT-AWS",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[-34.15,18.85,{"iconUrl":{"data":"https://cdn-icons-png.flaticon.com/512/1753/1753451.png","index":0},"iconWidth":30,"iconHeight":30,"iconAnchorX":15,"iconAnchorY":15},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"STRAND",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[-34.139,19.023,{"iconUrl":{"data":"https://cdn-icons-png.flaticon.com/512/1753/1753451.png","index":0},"iconWidth":30,"iconHeight":30,"iconAnchorX":15,"iconAnchorY":15},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"ELGIN EXP FARM",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[-33.9,18.5,{"iconUrl":{"data":"https://cdn-icons-png.flaticon.com/512/1753/1753451.png","index":0},"iconWidth":30,"iconHeight":30,"iconAnchorX":15,"iconAnchorY":15},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"YSTERPLANT(SAAFB)",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[-33.717,18.967,{"iconUrl":{"data":"https://cdn-icons-png.flaticon.com/512/1753/1753451.png","index":0},"iconWidth":30,"iconHeight":30,"iconAnchorX":15,"iconAnchorY":15},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"PAARL",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[-33.9,18.433,{"iconUrl":{"data":"https://cdn-icons-png.flaticon.com/512/1753/1753451.png","index":0},"iconWidth":30,"iconHeight":30,"iconAnchorX":15,"iconAnchorY":15},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"CAPE TOWN - PORTNET",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[-33.933,18.417,{"iconUrl":{"data":"https://cdn-icons-png.flaticon.com/512/1753/1753451.png","index":0},"iconWidth":30,"iconHeight":30,"iconAnchorX":15,"iconAnchorY":15},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"MOLTENO RESERVIOR",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[-34.2,18.433,{"iconUrl":{"data":"https://cdn-icons-png.flaticon.com/512/1753/1753451.png","index":0},"iconWidth":30,"iconHeight":30,"iconAnchorX":15,"iconAnchorY":15},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"SIMONSTOWN",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[-33.8,18.367,{"iconUrl":{"data":"https://cdn-icons-png.flaticon.com/512/1753/1753451.png","index":0},"iconWidth":30,"iconHeight":30,"iconAnchorX":15,"iconAnchorY":15},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"ROBBEN ISLAND",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"setView":[[-33.9575,18.8148],10,{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}}},"width":"100%","height":null,"sizingPolicy":{"defaultWidth":"100%","defaultHeight":400,"padding":0,"viewer":{"defaultWidth":null,"defaultHeight":null,"padding":null,"fill":true,"suppress":false,"paneHeight":null},"browser":{"defaultWidth":null,"defaultHeight":null,"padding":null,"fill":true,"external":false},"knitr":{"defaultWidth":null,"defaultHeight":null,"figure":true}},"dependencies":null,"elementId":null,"preRenderHook":["function (widget) ","{","    if (!is.null(widget$jsHooks$render)) {","        widget$jsHooks$render <- lapply(widget$jsHooks$render, ","            function(hook) {","                if (is.list(hook)) {","                  hook$code <- sprintf(hookWrapperTemplate, paste(hook$code, ","                    collapse = \"\\n\"))","                }","                else if (is.character(hook)) {","                  hook <- sprintf(hookWrapperTemplate, paste(hook, ","                    collapse = \"\\n\"))","                }","                else {","                  stop(\"Unknown hook class \", class(hook))","                }","                hook","            })","    }","    widget","}"],"jsHooks":[]}],"limits":{"lat":[-34.2,-33.717],"lng":[18.367,19.023]}},"evals":[],"jsHooks":[]}</script>
<p><br />
## Download weather data for the most promising station on the list</p>
<p>The first station seems to be most promising. It is the weather station of the airport of Cape Town, which has a high percentage of the interval covered. Data of other stations that are located directly on the coast are possibly even more affected by the coastal climate. Unfortunately, I could not find any information about the position of the weather station on the airport, but I hope it is representative enough for my case.
In the next code chunk the <code>handle_gsod</code> function is used to download data with <code>action</code> input <code>"download_weather"</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="getting-temperature-data.html#cb3-1" aria-hidden="true" tabindex="-1"></a>downloaded_weather<span class="ot">&lt;-</span><span class="fu">handle_gsod</span>(<span class="at">action=</span><span class="st">&quot;download_weather&quot;</span>,</span>
<span id="cb3-2"><a href="getting-temperature-data.html#cb3-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">location=</span>station_list<span class="sc">$</span>chillR_code[<span class="dv">1</span>],</span>
<span id="cb3-3"><a href="getting-temperature-data.html#cb3-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">time_interval=</span><span class="fu">c</span>(<span class="dv">1977</span>,<span class="dv">2020</span>))</span></code></pre></div>
<p><br />
## Convert the weather data into chillR format</p>
<p>When the data input has the right format, the <code>handle_gsod</code> function cleans the dataset, interpolates gaps and reports everything in a quality check addition.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="getting-temperature-data.html#cb4-1" aria-hidden="true" tabindex="-1"></a>cleaned_weather<span class="ot">&lt;-</span><span class="fu">handle_gsod</span>(downloaded_weather)</span></code></pre></div>
<table class=" lightable-paper lightable-hover" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; ">
<caption>
<span id="tab:unnamed-chunk-4">Table 9.2: </span>Table with data from <code>cleaned_weather</code>
</caption>
<thead>
<tr>
<th style="text-align:left;">
DATE
</th>
<th style="text-align:right;">
Year
</th>
<th style="text-align:right;">
Month
</th>
<th style="text-align:right;">
Day
</th>
<th style="text-align:right;">
Tmin
</th>
<th style="text-align:right;">
Tmax
</th>
<th style="text-align:right;">
Tmean
</th>
<th style="text-align:right;">
Prec
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1990-01-01 12:00:00
</td>
<td style="text-align:right;">
1990
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
16.500000
</td>
<td style="text-align:right;">
24.77778
</td>
<td style="text-align:right;">
19.94444
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
1990-01-02 12:00:00
</td>
<td style="text-align:right;">
1990
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
17.000000
</td>
<td style="text-align:right;">
24.00000
</td>
<td style="text-align:right;">
18.83333
</td>
<td style="text-align:right;">
0.254
</td>
</tr>
<tr>
<td style="text-align:left;">
1990-01-03 12:00:00
</td>
<td style="text-align:right;">
1990
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
13.000000
</td>
<td style="text-align:right;">
24.00000
</td>
<td style="text-align:right;">
19.72222
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
1990-01-04 12:00:00
</td>
<td style="text-align:right;">
1990
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
17.500000
</td>
<td style="text-align:right;">
26.61111
</td>
<td style="text-align:right;">
21.44444
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
1990-01-05 12:00:00
</td>
<td style="text-align:right;">
1990
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
18.611111
</td>
<td style="text-align:right;">
29.00000
</td>
<td style="text-align:right;">
22.33333
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
1990-01-06 12:00:00
</td>
<td style="text-align:right;">
1990
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
14.000000
</td>
<td style="text-align:right;">
29.00000
</td>
<td style="text-align:right;">
16.72222
</td>
<td style="text-align:right;">
3.556
</td>
</tr>
<tr>
<td style="text-align:left;">
1990-01-07 12:00:00
</td>
<td style="text-align:right;">
1990
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
12.888889
</td>
<td style="text-align:right;">
23.00000
</td>
<td style="text-align:right;">
18.00000
</td>
<td style="text-align:right;">
1.016
</td>
</tr>
<tr>
<td style="text-align:left;">
1990-01-08 12:00:00
</td>
<td style="text-align:right;">
1990
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7.777778
</td>
<td style="text-align:right;">
32.00000
</td>
<td style="text-align:right;">
21.44444
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
1990-01-09 12:00:00
</td>
<td style="text-align:right;">
1990
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
14.611111
</td>
<td style="text-align:right;">
31.88889
</td>
<td style="text-align:right;">
19.33333
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
1990-01-10 12:00:00
</td>
<td style="text-align:right;">
1990
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
17.000000
</td>
<td style="text-align:right;">
24.77778
</td>
<td style="text-align:right;">
20.55556
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
</tbody>
</table>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="making-hourly-temperatures.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="filling-gaps-in-temperature-records.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/09-getting_temp_data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
